<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <title>
  x86 Lock ¬∑ Michael Shalitin
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">


<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://www.youtube.com; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' default-src 'unsafe-eval' https://www.google-analytics.com https://cdn.jsdelivr.net/ https://static.cloudflareinsights.com https://cloudflareinsights.com; connect-src 'self' https://www.google-analytics.com https://static.cloudflareinsights.com https://cloudflareinsights.com;">




<meta name="author" content="Michael Shalitin">
<meta name="description" content="
  lock prefix
  
    
    Link to heading
  

◊î-lock prefix ◊î◊ï◊ê ◊ß◊ô◊ì◊ï◊û◊™ ◊©◊ú ◊©◊ú ◊î-opcode (◊î◊ß◊ô◊ì◊ï◊û◊™ ◊î◊ô◊ê 0xF0) ◊ï◊î◊ï◊ê ◊û◊ê◊§◊©◊® ◊ú◊ë◊¶◊¢ ◊§◊¢◊ï◊ú◊ï◊™ ◊ê◊ò◊ï◊û◊ô◊ï◊™.
◊î-lock prefix ◊í◊ï◊®◊û◊™ ◊ú◊ê◊ï◊™ LOCK# ◊©◊ú ◊î◊û◊¢◊ë◊ì ◊ú◊î◊ô◊©◊ê◊® ◊§◊¢◊ô◊ú ◊ë◊û◊î◊ú◊ö ◊ë◊ô◊¶◊ï◊¢ ◊î◊î◊ï◊®◊ê◊î ◊î◊û◊¶◊ï◊®◊§◊™ ◊ê◊ú◊ô◊î, ◊û◊î ◊©◊î◊ï◊§◊ö ◊ê◊™ ◊î◊î◊ï◊®◊ê◊î ◊ú◊ê◊ò◊ï◊û◊ô◊™. ◊ë◊°◊ë◊ô◊ë◊î ◊¢◊ù ◊®◊ô◊ë◊ï◊ô ◊û◊¢◊ë◊ì◊ô◊ù, ◊î◊ê◊ï◊™ LOCK# ◊û◊ë◊ò◊ô◊ó ◊©◊î◊û◊¢◊ë◊ì ◊î◊û◊ó◊ñ◊ô◊ß ◊ë◊ê◊ï◊™ ◊ô◊© ◊©◊ô◊û◊ï◊© ◊ë◊ú◊¢◊ì◊ô ◊ë◊õ◊ú ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊©◊ï◊™◊£ ◊ë◊ñ◊û◊ü ◊©◊î◊ê◊ï◊™ ◊§◊¢◊ô◊ú.
◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ LOCK ◊®◊ß ◊ú◊ß◊ë◊ï◊¶◊î ◊û◊°◊ï◊ô◊û◊™ ◊©◊ú ◊î◊ï◊®◊ê◊ï◊™, ◊ï◊®◊ß ◊ë◊û◊ß◊®◊ô◊ù ◊©◊ë◊î◊ù ◊ê◊ï◊§◊®◊†◊ì ◊î◊ô◊¢◊ì ◊©◊ú ◊î◊î◊ï◊®◊ê◊î ◊î◊ï◊ê ◊ê◊ï◊§◊®◊†◊ì ◊ñ◊ô◊õ◊®◊ï◊ü. ◊î◊ï◊®◊ê◊ï◊™ ◊û◊°◊ï◊ô◊û◊ï◊™ ◊©◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ú◊î◊ü ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ LOCK ◊õ◊ï◊ú◊ú◊ï◊™:">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="x86 Lock">
  <meta name="twitter:description" content="lock prefix Link to heading ◊î-lock prefix ◊î◊ï◊ê ◊ß◊ô◊ì◊ï◊û◊™ ◊©◊ú ◊©◊ú ◊î-opcode (◊î◊ß◊ô◊ì◊ï◊û◊™ ◊î◊ô◊ê 0xF0) ◊ï◊î◊ï◊ê ◊û◊ê◊§◊©◊® ◊ú◊ë◊¶◊¢ ◊§◊¢◊ï◊ú◊ï◊™ ◊ê◊ò◊ï◊û◊ô◊ï◊™.
◊î-lock prefix ◊í◊ï◊®◊û◊™ ◊ú◊ê◊ï◊™ LOCK# ◊©◊ú ◊î◊û◊¢◊ë◊ì ◊ú◊î◊ô◊©◊ê◊® ◊§◊¢◊ô◊ú ◊ë◊û◊î◊ú◊ö ◊ë◊ô◊¶◊ï◊¢ ◊î◊î◊ï◊®◊ê◊î ◊î◊û◊¶◊ï◊®◊§◊™ ◊ê◊ú◊ô◊î, ◊û◊î ◊©◊î◊ï◊§◊ö ◊ê◊™ ◊î◊î◊ï◊®◊ê◊î ◊ú◊ê◊ò◊ï◊û◊ô◊™. ◊ë◊°◊ë◊ô◊ë◊î ◊¢◊ù ◊®◊ô◊ë◊ï◊ô ◊û◊¢◊ë◊ì◊ô◊ù, ◊î◊ê◊ï◊™ LOCK# ◊û◊ë◊ò◊ô◊ó ◊©◊î◊û◊¢◊ë◊ì ◊î◊û◊ó◊ñ◊ô◊ß ◊ë◊ê◊ï◊™ ◊ô◊© ◊©◊ô◊û◊ï◊© ◊ë◊ú◊¢◊ì◊ô ◊ë◊õ◊ú ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊©◊ï◊™◊£ ◊ë◊ñ◊û◊ü ◊©◊î◊ê◊ï◊™ ◊§◊¢◊ô◊ú.
◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ LOCK ◊®◊ß ◊ú◊ß◊ë◊ï◊¶◊î ◊û◊°◊ï◊ô◊û◊™ ◊©◊ú ◊î◊ï◊®◊ê◊ï◊™, ◊ï◊®◊ß ◊ë◊û◊ß◊®◊ô◊ù ◊©◊ë◊î◊ù ◊ê◊ï◊§◊®◊†◊ì ◊î◊ô◊¢◊ì ◊©◊ú ◊î◊î◊ï◊®◊ê◊î ◊î◊ï◊ê ◊ê◊ï◊§◊®◊†◊ì ◊ñ◊ô◊õ◊®◊ï◊ü. ◊î◊ï◊®◊ê◊ï◊™ ◊û◊°◊ï◊ô◊û◊ï◊™ ◊©◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ú◊î◊ü ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ LOCK ◊õ◊ï◊ú◊ú◊ï◊™:">

<meta property="og:url" content="https://smichaelshal.github.io/he/posts/atomic/x86-lock/">
  <meta property="og:site_name" content="Michael Shalitin">
  <meta property="og:title" content="x86 Lock">
  <meta property="og:description" content="lock prefix Link to heading ◊î-lock prefix ◊î◊ï◊ê ◊ß◊ô◊ì◊ï◊û◊™ ◊©◊ú ◊©◊ú ◊î-opcode (◊î◊ß◊ô◊ì◊ï◊û◊™ ◊î◊ô◊ê 0xF0) ◊ï◊î◊ï◊ê ◊û◊ê◊§◊©◊® ◊ú◊ë◊¶◊¢ ◊§◊¢◊ï◊ú◊ï◊™ ◊ê◊ò◊ï◊û◊ô◊ï◊™.
◊î-lock prefix ◊í◊ï◊®◊û◊™ ◊ú◊ê◊ï◊™ LOCK# ◊©◊ú ◊î◊û◊¢◊ë◊ì ◊ú◊î◊ô◊©◊ê◊® ◊§◊¢◊ô◊ú ◊ë◊û◊î◊ú◊ö ◊ë◊ô◊¶◊ï◊¢ ◊î◊î◊ï◊®◊ê◊î ◊î◊û◊¶◊ï◊®◊§◊™ ◊ê◊ú◊ô◊î, ◊û◊î ◊©◊î◊ï◊§◊ö ◊ê◊™ ◊î◊î◊ï◊®◊ê◊î ◊ú◊ê◊ò◊ï◊û◊ô◊™. ◊ë◊°◊ë◊ô◊ë◊î ◊¢◊ù ◊®◊ô◊ë◊ï◊ô ◊û◊¢◊ë◊ì◊ô◊ù, ◊î◊ê◊ï◊™ LOCK# ◊û◊ë◊ò◊ô◊ó ◊©◊î◊û◊¢◊ë◊ì ◊î◊û◊ó◊ñ◊ô◊ß ◊ë◊ê◊ï◊™ ◊ô◊© ◊©◊ô◊û◊ï◊© ◊ë◊ú◊¢◊ì◊ô ◊ë◊õ◊ú ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊©◊ï◊™◊£ ◊ë◊ñ◊û◊ü ◊©◊î◊ê◊ï◊™ ◊§◊¢◊ô◊ú.
◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ LOCK ◊®◊ß ◊ú◊ß◊ë◊ï◊¶◊î ◊û◊°◊ï◊ô◊û◊™ ◊©◊ú ◊î◊ï◊®◊ê◊ï◊™, ◊ï◊®◊ß ◊ë◊û◊ß◊®◊ô◊ù ◊©◊ë◊î◊ù ◊ê◊ï◊§◊®◊†◊ì ◊î◊ô◊¢◊ì ◊©◊ú ◊î◊î◊ï◊®◊ê◊î ◊î◊ï◊ê ◊ê◊ï◊§◊®◊†◊ì ◊ñ◊ô◊õ◊®◊ï◊ü. ◊î◊ï◊®◊ê◊ï◊™ ◊û◊°◊ï◊ô◊û◊ï◊™ ◊©◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ú◊î◊ü ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ LOCK ◊õ◊ï◊ú◊ú◊ï◊™:">
  <meta property="og:locale" content="he">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-09-01T00:00:00+00:00">
    <meta property="article:tag" content="Atomic">
    <meta property="article:tag" content="X86">
    <meta property="article:tag" content="Lock">
    <meta property="article:tag" content="Lock-Prefix">
    <meta property="article:tag" content="Asm">
    <meta property="article:tag" content="Cpu">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/atomic/exclusive/">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/atomic/atomic/">




<link rel="canonical" href="https://smichaelshal.github.io/he/posts/atomic/x86-lock/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.6c967191184c40e901e41977158c33a73a2cfa2d9413cf73dddd6732eeae7af4.css" integrity="sha256-bJZxkRhMQOkB5Bl3FYwzpzos&#43;i2UE89z3d1nMu6uevQ=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://smichaelshal.github.io/he/">
      Michael Shalitin
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/he/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/he/posts/">Blog</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/posts/atomic/x86-lock/">üá¨üáß</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://smichaelshal.github.io/he/posts/atomic/x86-lock/">
              x86 Lock
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-09-01T00:00:00Z">
                ◊°◊§◊ò◊û◊ë◊® 1, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-newspaper" aria-hidden="true"></i>
                1122 ◊û◊ô◊ú◊ô◊ù
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/he/categories/atomic/">Atomic</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/he/tags/atomic/">Atomic</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/x86/">X86</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/lock/">Lock</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/lock-prefix/">Lock-Prefix</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/asm/">Asm</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/cpu/">Cpu</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/split-lock/">Split-Lock</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/linux/">Linux</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/cache/">Cache</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/kernel/">Kernel</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/ordering/">Ordering</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/rmw/">Rmw</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <h2 id="lock-prefix">
  lock prefix
  <a class="heading-link" href="#lock-prefix">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>◊î-lock prefix ◊î◊ï◊ê ◊ß◊ô◊ì◊ï◊û◊™ ◊©◊ú ◊©◊ú ◊î-opcode (◊î◊ß◊ô◊ì◊ï◊û◊™ ◊î◊ô◊ê <code>0xF0</code>) ◊ï◊î◊ï◊ê ◊û◊ê◊§◊©◊® ◊ú◊ë◊¶◊¢ ◊§◊¢◊ï◊ú◊ï◊™ ◊ê◊ò◊ï◊û◊ô◊ï◊™.</p>
<p>◊î-lock prefix ◊í◊ï◊®◊û◊™ ◊ú◊ê◊ï◊™ <code>LOCK#</code> ◊©◊ú ◊î◊û◊¢◊ë◊ì ◊ú◊î◊ô◊©◊ê◊® ◊§◊¢◊ô◊ú ◊ë◊û◊î◊ú◊ö ◊ë◊ô◊¶◊ï◊¢ ◊î◊î◊ï◊®◊ê◊î ◊î◊û◊¶◊ï◊®◊§◊™ ◊ê◊ú◊ô◊î, ◊û◊î ◊©◊î◊ï◊§◊ö ◊ê◊™ ◊î◊î◊ï◊®◊ê◊î ◊ú◊ê◊ò◊ï◊û◊ô◊™. ◊ë◊°◊ë◊ô◊ë◊î ◊¢◊ù ◊®◊ô◊ë◊ï◊ô ◊û◊¢◊ë◊ì◊ô◊ù, ◊î◊ê◊ï◊™ <code>LOCK#</code> ◊û◊ë◊ò◊ô◊ó ◊©◊î◊û◊¢◊ë◊ì ◊î◊û◊ó◊ñ◊ô◊ß ◊ë◊ê◊ï◊™ ◊ô◊© ◊©◊ô◊û◊ï◊© ◊ë◊ú◊¢◊ì◊ô ◊ë◊õ◊ú ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊©◊ï◊™◊£ ◊ë◊ñ◊û◊ü ◊©◊î◊ê◊ï◊™ ◊§◊¢◊ô◊ú.</p>
<p>◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ <code>LOCK</code> ◊®◊ß ◊ú◊ß◊ë◊ï◊¶◊î ◊û◊°◊ï◊ô◊û◊™ ◊©◊ú ◊î◊ï◊®◊ê◊ï◊™, ◊ï◊®◊ß ◊ë◊û◊ß◊®◊ô◊ù ◊©◊ë◊î◊ù ◊ê◊ï◊§◊®◊†◊ì ◊î◊ô◊¢◊ì ◊©◊ú ◊î◊î◊ï◊®◊ê◊î ◊î◊ï◊ê ◊ê◊ï◊§◊®◊†◊ì ◊ñ◊ô◊õ◊®◊ï◊ü. ◊î◊ï◊®◊ê◊ï◊™ ◊û◊°◊ï◊ô◊û◊ï◊™ ◊©◊†◊ô◊™◊ü ◊ú◊î◊ï◊°◊ô◊£ ◊ú◊î◊ü ◊ê◊™ ◊ß◊ô◊ì◊ï◊û◊™ <code>LOCK</code> ◊õ◊ï◊ú◊ú◊ï◊™:</p>
<ul>
<li><code>ADD</code></li>
<li><code>AND</code></li>
<li><code>BTS</code></li>
<li><code>CMPXCHG</code></li>
<li><code>DEC</code></li>
<li><code>INC</code></li>
<li><code>SUB</code></li>
<li><code>XOR</code></li>
<li><code>XADD</code></li>
<li><code>XCHG</code></li>
</ul>
<p>◊©◊ô◊û◊ï◊© ◊ë◊ß◊ô◊ì◊ï◊û◊™ <code>LOCK</code> ◊¢◊ù ◊ê◊ó◊™ ◊û◊î◊î◊ï◊®◊ê◊ï◊™ ◊î◊ú◊ú◊ï ◊õ◊ê◊©◊® ◊ê◊ï◊§◊®◊†◊ì ◊î◊û◊ß◊ï◊® ◊î◊ï◊ê ◊ë◊ñ◊ô◊õ◊®◊ï◊ü ◊¢◊ú◊ï◊ú ◊ú◊í◊®◊ï◊ù ◊ú-exception ◊ß◊ï◊ì ◊ú◊ê ◊û◊ï◊í◊ì◊® (<code>#UD</code>). ◊õ◊û◊ï ◊õ◊ü, exception ◊õ◊ñ◊î ◊ô◊™◊®◊ó◊© ◊ê◊ù ◊ß◊ô◊ì◊ï◊û◊™ <code>LOCK</code> ◊™◊™◊ï◊ï◊°◊£ ◊ú◊î◊ï◊®◊ê◊î ◊©◊ê◊ô◊†◊î ◊õ◊ú◊ï◊ú◊î ◊ë◊®◊©◊ô◊û◊î ◊ñ◊ï. ◊¢◊ù ◊ñ◊ê◊™, ◊ô◊© ◊ú◊¶◊ô◊ô◊ü ◊©◊î◊ï◊®◊ê◊™ <code>XCHG</code> ◊™◊û◊ô◊ì ◊û◊í◊ì◊ô◊®◊î ◊ê◊™ ◊î◊ê◊ï◊™ <code>LOCK#</code>, ◊ë◊ô◊ü ◊ê◊ù ◊ß◊ô◊ì◊ï◊û◊™ <code>LOCK</code> ◊ß◊ô◊ô◊û◊™ ◊ê◊ï ◊ú◊ê.</p>
<h2 id="cache-lock--bus-lock">
  cache lock &amp; bus lock
  <a class="heading-link" href="#cache-lock--bus-lock">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>◊î◊û◊¢◊ë◊ì ◊û◊ë◊ò◊ô◊ó ◊ê◊ò◊ï◊û◊ô◊ï◊™ ◊ú◊§◊¢◊ï◊ú◊ï◊™ RMW ◊¢◊ú ◊ô◊ì◊ô ◊†◊¢◊ô◊ú◊î ◊©◊ú ◊®◊õ◊ô◊ë◊ô◊ù ◊ï◊û◊™◊ü ◊í◊ô◊©◊î ◊ë◊ú◊¢◊ì◊ô◊™ ◊ú◊û◊¢◊ë◊ì ◊î◊û◊ë◊¶◊¢. ◊î◊û◊¢◊ë◊ì ◊™◊ï◊û◊ö ◊ë◊†◊¢◊ô◊ú◊™ bus ◊ú◊¶◊ï◊®◊ö ◊ë◊ô◊¶◊ï◊¢ ◊§◊¢◊ï◊ú◊ï◊™ ◊ñ◊ô◊õ◊®◊ï◊ü ◊†◊ë◊ó◊®◊ï◊™, ◊õ◊û◊ï ◊§◊¢◊ï◊ú◊ï◊™ RMW ◊ë◊ê◊ñ◊ï◊®◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊©◊ï◊™◊§◊ô◊ù, ◊ê◊©◊® ◊ó◊ô◊ô◊ë◊ï◊™ ◊ú◊î◊™◊ë◊¶◊¢ ◊ë◊¶◊ï◊®◊î ◊ê◊ò◊ï◊û◊ô◊™.</p>
<p>◊ë◊û◊¢◊ë◊ì◊ô ◊ô◊©◊†◊ô◊ù ◊ô◊ó◊°◊ô◊™, ◊ê◊ï◊™ <code>LOCK#</code> ◊™◊û◊ô◊ì ◊û◊ï◊§◊¢◊ú ◊¢◊ú ◊î-bus ◊ë◊û◊î◊ú◊ö ◊§◊¢◊ï◊ú◊™ lock, ◊í◊ù ◊õ◊ê◊©◊® ◊ê◊ñ◊ï◊® ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊†◊†◊¢◊ú ◊†◊©◊û◊® ◊ë-cache ◊î◊§◊†◊ô◊û◊ô ◊©◊ú ◊î◊û◊¢◊ë◊ì.</p>
<p>◊ë◊û◊¢◊ë◊ì◊ô ◊ô◊ï◊™◊® ◊ó◊ì◊©◊ô◊ù (◊õ◊û◊ï ◊ë◊û◊©◊§◊ó◊ï◊™ ◊î◊û◊¢◊ë◊ì◊ô◊ù P6 ◊ï◊î◊û◊¢◊ë◊ì◊ô◊ù ◊î◊ó◊ì◊©◊ô◊ù ◊ô◊ï◊™◊® ◊©◊ú intel), ◊ê◊ù ◊ê◊ñ◊ï◊® ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊†◊†◊¢◊ú ◊ë◊û◊î◊ú◊ö ◊§◊¢◊ï◊ú◊™ lock ◊û◊ê◊ï◊ó◊°◊ü ◊ë-cahce L1 ◊ê◊ï L2 ◊©◊ú ◊î◊û◊¢◊ë◊ì ◊õ◊ñ◊ô◊õ◊®◊ï◊ü write-back ◊ï◊õ◊ú◊ï◊ú ◊õ◊ï◊ú◊ï ◊ë-cache line ◊ê◊ó◊™, ◊ô◊ô◊™◊õ◊ü ◊©◊î◊û◊¢◊ë◊ì ◊ú◊ê ◊ô◊§◊¢◊ô◊ú ◊ê◊™ ◊ê◊ï◊™ <code>LOCK#</code> ◊¢◊ú ◊î-bus. ◊ë◊û◊ß◊®◊î ◊ñ◊î, ◊î◊û◊¢◊ë◊ì ◊ô◊ò◊§◊ú ◊ë◊†◊¢◊ô◊ú◊î ◊ë◊ê◊ï◊§◊ü ◊§◊†◊ô◊û◊ô ◊¢◊ú ◊ô◊ì◊ô ◊©◊ô◊†◊ï◊ô ◊û◊ô◊ß◊ï◊ù ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊ë-cache ◊¢◊¶◊û◊ï, ◊™◊ï◊ö ◊©◊ô◊û◊ï◊© ◊ë◊û◊†◊í◊†◊ï◊ü ◊ß◊ï◊î◊®◊†◊ò◊ô◊ï◊™ ◊î-cache ◊©◊ú◊ï ◊õ◊ì◊ô ◊ú◊î◊ë◊ò◊ô◊ó ◊©◊î◊§◊¢◊ï◊ú◊î ◊û◊™◊ë◊¶◊¢◊™ ◊ë◊¶◊ï◊®◊î ◊ê◊ò◊ï◊û◊ô◊™ (◊ë-amd ◊ú◊û◊©◊ú ◊û◊©◊™◊û◊©◊ô◊ù ◊ë◊§◊®◊ï◊ò◊ï◊ß◊ï◊ú MOESDIF). ◊™◊î◊ú◊ô◊ö ◊ñ◊î ◊†◊ß◊®◊ê cache locking ◊ê◊ï cacheable lock. ◊û◊†◊í◊†◊ï◊ü ◊ß◊ï◊î◊®◊†◊ò◊ô◊ï◊™ ◊î-cache ◊û◊ï◊†◊¢ ◊ê◊ï◊ò◊ï◊û◊ò◊ô◊™ ◊û◊û◊°◊§◊® ◊û◊¢◊ë◊ì◊ô◊ù ◊©◊©◊ï◊û◊®◊ô◊ù ◊ê◊™ ◊ê◊ï◊™◊ï ◊ê◊ñ◊ï◊® ◊ñ◊ô◊õ◊®◊ï◊ü ◊ë-cache ◊ú◊©◊†◊ï◊™ ◊ê◊™ ◊î◊†◊™◊ï◊†◊ô◊ù ◊ë◊ê◊ï◊™◊ï ◊ê◊ñ◊ï◊® ◊ë◊ï-◊ñ◊û◊†◊ô◊™.</p>
<p>◊ë◊ë◊ô◊¶◊ï◊¢ ◊í◊ô◊©◊î ◊ú◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊°◊ï◊í cacheable ◊û◊ó◊ï◊ú◊ß◊™ ◊¢◊ú ◊§◊†◊ô cache lines ◊ï◊í◊ë◊ï◊ú◊ï◊™ page-◊ô◊ù, ◊ó◊ú◊ß ◊û◊î◊û◊¢◊ë◊ì◊ô◊ù ◊ê◊ô◊†◊ù ◊û◊ë◊ò◊ô◊ó◊ô◊ù ◊ê◊ò◊ï◊û◊ô◊ï◊™ ◊í◊ô◊©◊î ◊ñ◊ï ◊ë◊û◊¶◊ë ◊®◊í◊ô◊ú. ◊õ◊ì◊ô ◊ú◊î◊ë◊ò◊ô◊ó ◊ê◊ò◊ï◊û◊ô◊ï◊™ ◊ë◊û◊ß◊®◊ô◊ù ◊õ◊ê◊ú◊î, ◊†◊ì◊®◊©◊ô◊ù ◊ê◊ï◊™◊ï◊™ ◊ë◊ß◊®◊™ bus ◊©◊û◊ê◊§◊©◊®◊ô◊ù ◊ú◊™◊™-◊û◊¢◊®◊õ◊ï◊™ ◊ñ◊ô◊õ◊®◊ï◊ü ◊ó◊ô◊¶◊ï◊†◊ô◊ï◊™ ◊ú◊î◊ë◊ò◊ô◊ó ◊©◊í◊ô◊©◊î ◊û◊ó◊ï◊ú◊ß◊™ ◊™◊î◊ô◊î ◊ê◊ò◊ï◊û◊ô◊™. ◊¢◊ù ◊ñ◊ê◊™, ◊í◊ô◊©◊ï◊™ ◊ú◊ê ◊û◊ô◊ï◊©◊®◊ï◊™ ◊ú◊†◊™◊ï◊†◊ô◊ù ◊¢◊ú◊ï◊ú◊ï◊™ ◊ú◊§◊í◊ï◊¢ ◊ë◊¶◊ï◊®◊î ◊û◊©◊û◊¢◊ï◊™◊ô◊™ ◊ë◊ë◊ô◊¶◊ï◊¢◊ô ◊î◊û◊¢◊ë◊ì ◊ï◊ú◊õ◊ü ◊ô◊© ◊ú◊î◊ô◊û◊†◊¢ ◊û◊î◊ü ◊õ◊õ◊ú ◊î◊ê◊§◊©◊®.</p>
<p>◊î◊ê◊ï◊™ <code>LOCK#</code> ◊©◊û◊ï◊í◊ì◊® ◊ê◊ï◊ò◊ï◊û◊ò◊ô◊™ ◊ë◊û◊î◊ú◊ö ◊§◊¢◊ï◊ú◊ï◊™ ◊ñ◊ô◊õ◊®◊ï◊ü ◊ß◊®◊ô◊ò◊ô◊ï◊™ ◊û◊°◊ï◊ô◊û◊ï◊™, ◊õ◊ì◊ô ◊ú◊†◊¢◊ï◊ú ◊ê◊™ ◊î-bus ◊©◊ú ◊î◊û◊¢◊®◊õ◊™. ◊õ◊ê◊©◊® ◊ê◊ï◊™ ◊ñ◊î ◊û◊ï◊§◊¢◊ú, ◊õ◊ú ◊ë◊ß◊©◊î ◊ú◊©◊ú◊ô◊ò◊î ◊ë-bus ◊û◊¶◊ì ◊û◊¢◊ë◊ì◊ô◊ù ◊ê◊ó◊®◊ô◊ù ◊ê◊ï ◊°◊ï◊õ◊†◊ô bus ◊†◊ó◊°◊û◊™.</p>
<p>◊õ◊ì◊ô ◊ú◊î◊ë◊ò◊ô◊ó ◊ë◊ê◊ï◊§◊ü ◊û◊§◊ï◊®◊© ◊ê◊™ ◊î◊°◊û◊†◊ò◊ô◊ß◊î ◊©◊ú lock, ◊™◊ï◊õ◊†◊î ◊ô◊õ◊ï◊ú◊î ◊ú◊î◊©◊™◊û◊© ◊ë◊ß◊ô◊ì◊ï◊û◊™ <code>lock</code> ◊ô◊ó◊ì ◊¢◊ù ◊ß◊ë◊ï◊¶◊î ◊û◊°◊ï◊ô◊û◊™ ◊©◊ú ◊î◊ï◊®◊ê◊ï◊™, ◊õ◊ê◊©◊® ◊î◊ï◊®◊ê◊ï◊™ ◊ê◊ú◊î ◊û◊©◊û◊©◊ï◊™ ◊ú◊©◊ô◊†◊ï◊ô ◊û◊ô◊ß◊ï◊ù ◊ë◊ñ◊ô◊õ◊®◊ï◊ü. ◊ê◊ù ◊ß◊ô◊ì◊ï◊û◊™ <code>lock</code> ◊û◊©◊û◊©◊™ ◊ë◊î◊ï◊®◊ê◊î ◊ê◊ó◊®◊™ ◊©◊ê◊ô◊†◊î ◊û◊ï◊®◊©◊™ ◊ú◊ß◊ë◊ú <code>lock</code> ◊ê◊ï ◊õ◊©◊ú◊ê ◊û◊™◊ë◊¶◊¢◊™ ◊õ◊™◊ô◊ë◊î ◊ú◊ñ◊ô◊õ◊®◊ï◊ü, ◊ô◊ï◊§◊ß exception ◊ß◊ï◊ì ◊ú◊ê ◊ó◊ï◊ß◊ô (<code>#UD</code>).</p>
<p>◊ó◊ú◊ß ◊û◊û◊¢◊ë◊ì◊ô Intel ◊ï-AMD ◊û◊°◊§◊ß◊ô◊ù ◊ê◊§◊©◊®◊ï◊™ ◊ú◊ì◊ï◊ï◊ó ◊¢◊ú ◊†◊¢◊ô◊ú◊™ bus ◊ú◊™◊ï◊õ◊†◊™ ◊î◊û◊¢◊®◊õ◊™ ◊ë◊ê◊û◊¶◊¢◊ï◊™ ◊î-exception <code>#DB</code>. ◊û◊¢◊ë◊ì◊ô◊ù ◊ó◊ì◊©◊ô◊ù ◊û◊ê◊§◊©◊®◊ô◊ù ◊í◊ù ◊ì◊ô◊ï◊ï◊ó ◊¢◊ú ◊í◊ô◊©◊î split lock ◊©◊ô◊õ◊ï◊ú◊î ◊ú◊î◊ï◊ë◊ô◊ú ◊ú-exception <code>#AC</code>.</p>
<p>◊ë◊†◊ï◊°◊£ ◊ê◊ï◊™ <code>LOCK#</code> ◊¢◊ú◊ï◊ú ◊í◊ù ◊ú◊í◊®◊ï◊ù ◊ú-VM Exit ◊ë◊î◊™◊ê◊ù ◊ú◊î◊í◊ì◊®◊ï◊™ ◊û◊°◊ï◊ô◊û◊ï◊™.</p>
<h2 id="split-lock">
  split lock
  <a class="heading-link" href="#split-lock">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>◊ë◊û◊¢◊®◊õ◊ï◊™ x86, ◊ë◊†◊ô◊í◊ï◊ì ◊ú◊ê◊®◊õ◊ô◊ò◊ß◊ò◊ï◊®◊ï◊™ ◊®◊ë◊ï◊™ ◊ê◊ó◊®◊ï◊™, ◊ß◊ô◊ô◊û◊™ ◊™◊û◊ô◊õ◊î ◊ë◊§◊¢◊ï◊ú◊ï◊™ ◊ê◊ò◊ï◊û◊ô◊ï◊™ ◊©◊û◊©◊§◊ô◊¢◊ï◊™ ◊¢◊ú ◊ô◊ï◊™◊® ◊û-cache line ◊ê◊ó◊™. ◊¢◊ù ◊ñ◊ê◊™, ◊™◊û◊ô◊õ◊î ◊ñ◊ï ◊í◊ï◊ë◊î ◊û◊ó◊ô◊®, ◊î◊ü ◊ë◊ë◊ô◊¶◊ï◊¢◊ô ◊î◊û◊¢◊®◊õ◊™ ◊ï◊î◊ü ◊ë◊î◊ô◊ë◊ò◊ô ◊î◊ê◊ë◊ò◊ó◊î.</p>
<p>◊î◊ê◊™◊í◊® ◊ë◊§◊¢◊ï◊ú◊ï◊™ ◊ê◊ò◊ï◊û◊ô◊ï◊™ ◊©◊ó◊ï◊¶◊ï◊™ ◊í◊ë◊ï◊ú◊ï◊™ ◊©◊ú ◊©◊ï◊®◊ï◊™ cache ◊†◊ï◊ë◊¢ ◊û◊î◊¶◊ï◊®◊ö ◊ú◊î◊ë◊ò◊ô◊ó ◊©◊©◊†◊ô ◊î-cache lines ◊ô◊î◊ô◊ï ◊û◊ï◊í◊†◊ô◊ù ◊ë◊ï-◊ñ◊û◊†◊ô◊™ ◊û◊§◊†◊ô ◊í◊ô◊©◊î ◊û◊ß◊ë◊ô◊ú◊î. ◊õ◊ì◊ô ◊ú◊û◊†◊ï◊¢ ◊ß◊ï◊†◊§◊ú◊ô◊ß◊ò◊ô◊ù ◊õ◊ê◊ú◊î, ◊†◊ì◊®◊©◊™ ◊†◊¢◊ô◊ú◊™ ◊î-bus ◊ú◊û◊©◊ö ◊õ◊ú ◊ñ◊û◊ü ◊î◊§◊¢◊ï◊ú◊î, ◊ì◊ë◊® ◊©◊ô◊õ◊ï◊ú ◊ú◊í◊®◊ï◊ù ◊ú◊¢◊ô◊õ◊ï◊ë ◊©◊ú ◊õ◊ú ◊û◊¢◊ë◊ì ◊ê◊ó◊® ◊ë◊û◊¢◊®◊õ◊™.</p>
<p>◊†◊¢◊ô◊ú◊™ bus ◊î◊û◊¢◊®◊õ◊™ ◊û◊™◊®◊ó◊©◊™ ◊õ◊ê◊©◊® ◊û◊™◊ë◊¶◊¢◊™ ◊§◊¢◊ï◊ú◊î ◊ê◊ò◊ï◊û◊ô◊™ ◊©◊ë◊î ◊î◊ê◊ï◊§◊®◊†◊ì ◊ó◊ï◊¶◊î ◊©◊†◊ô cache lines. ◊û◊õ◊ô◊ï◊ï◊ü ◊©◊î◊ê◊ï◊§◊®◊†◊ì ◊û◊™◊§◊®◊° ◊¢◊ú ◊§◊†◊ô ◊©◊†◊ô cache lines ◊ï◊î◊§◊¢◊ï◊ú◊î ◊ó◊ô◊ô◊ë◊™ ◊ú◊î◊™◊ë◊¶◊¢ ◊ë◊ê◊ò◊ï◊û◊ô◊ï◊™, ◊î◊û◊¢◊®◊õ◊™ ◊†◊ê◊ú◊¶◊™ ◊ú◊†◊¢◊ï◊ú ◊ê◊™ ◊î-bus ◊¢◊ú ◊û◊†◊™ ◊ú◊ê◊§◊©◊® ◊ú◊û◊¢◊ë◊ì ◊í◊ô◊©◊î ◊û◊°◊ï◊†◊õ◊®◊†◊™ ◊ú◊©◊™◊ô ◊î◊©◊ï◊®◊ï◊™ ◊î◊ú◊ú◊ï.</p>
<p>◊†◊¢◊ô◊ú◊™ bus ◊©◊ú ◊î◊û◊¢◊®◊õ◊™ ◊ô◊õ◊ï◊ú◊î ◊ú◊î◊™◊®◊ó◊© ◊ë◊¢◊ß◊ë◊ï◊™ split lock, ◊õ◊ú◊ï◊û◊® ◊í◊ô◊©◊™ lock ◊ú◊ñ◊ô◊õ◊®◊ï◊ü write-back ◊©◊ë◊ï ◊î◊ê◊ï◊§◊®◊†◊ì ◊û◊ó◊ï◊ú◊ß ◊ë◊ô◊ü ◊©◊™◊ô cache lines, ◊ê◊ï ◊ë◊¢◊ß◊ë◊ï◊™ ◊õ◊ú ◊í◊ô◊©◊™ lock ◊ú◊ñ◊ô◊õ◊®◊ï◊ü ◊©◊ê◊ô◊†◊ï ◊û◊°◊ï◊í write-back. ◊†◊¢◊ô◊ú◊î ◊ñ◊ï ◊í◊ï◊®◊û◊™ ◊ú◊¢◊ô◊õ◊ï◊ë ◊û◊©◊û◊¢◊ï◊™◊ô, ◊î◊¢◊©◊ï◊ô ◊ú◊î◊™◊ê◊®◊ö ◊ú◊ê◊ú◊§◊ô ◊û◊ó◊ñ◊ï◊®◊ô◊ù, ◊ë◊î◊©◊ï◊ï◊ê◊î ◊ú◊§◊¢◊ï◊ú◊î ◊ê◊ò◊ï◊û◊ô◊™ ◊î◊û◊™◊ë◊¶◊¢◊™ ◊ë◊™◊ï◊ö cache line ◊ê◊ó◊™. ◊û◊¢◊ë◊® ◊ú◊õ◊ö, ◊î◊ô◊ê ◊û◊©◊§◊ô◊¢◊î ◊ú◊®◊¢◊î ◊¢◊ú ◊î◊ë◊ô◊¶◊ï◊¢◊ô◊ù ◊©◊ú ◊ú◊ô◊ë◊ï◊™ ◊ê◊ó◊®◊ï◊™ ◊ë◊û◊¢◊ë◊ì ◊ï◊ô◊õ◊ï◊ú◊î ◊ú◊í◊®◊ï◊ù ◊ú◊ô◊®◊ô◊ì◊î ◊õ◊ú◊ú◊ô◊™ ◊ë◊ë◊ô◊¶◊ï◊¢◊ô ◊î◊û◊¢◊®◊õ◊™ ◊õ◊ï◊ú◊î.</p>
<p>◊ë◊¢◊¶◊ù, ◊í◊ô◊©◊™ split lock ◊î◊ô◊ê ◊í◊ô◊©◊î ◊ë◊ú◊™◊ô ◊™◊ß◊ô◊†◊î ◊ú◊ñ◊ô◊õ◊®◊ï◊ü, ◊û◊©◊î◊ï ◊©◊ê◊®◊õ◊ô◊ò◊ß◊ò◊ï◊®◊™ x86 ◊î◊ô◊ô◊™◊î ◊°◊ú◊ó◊†◊ô◊™ ◊õ◊ú◊§◊ô◊ï ◊ë◊ê◊ï◊§◊ü ◊ô◊ó◊°◊ô. ◊ê◊ö ◊õ◊ê◊ü ◊ô◊© ◊î◊ë◊ì◊ú ◊ó◊©◊ï◊ë: ◊ë◊¢◊ï◊ì ◊©◊í◊ô◊©◊î ◊ú◊ê ◊û◊ô◊ï◊©◊®◊™ ◊®◊í◊ô◊ú◊î ◊í◊ï◊®◊û◊™ ◊ú◊î◊ê◊ò◊î ◊ë◊ë◊ô◊¶◊ï◊¢ ◊î◊§◊¢◊ï◊ú◊î ◊î◊°◊§◊¶◊ô◊§◊ô◊™ ◊ë◊ú◊ë◊ì, split locks ◊í◊ï◊®◊û◊ô◊ù ◊ú◊î◊ê◊ò◊î ◊ë◊ë◊ô◊¶◊ï◊¢◊ô◊ù ◊©◊ú ◊î◊û◊¢◊®◊õ◊™ ◊õ◊ï◊ú◊î ◊õ◊ï◊ú◊ú ◊®◊õ◊ô◊ë◊ô◊ù ◊ó◊ô◊¶◊ï◊†◊ô◊ô◊ù ◊õ◊û◊ï ◊®◊õ◊ô◊ë◊ô DMA. ◊î◊¢◊ô◊õ◊ï◊ë ◊©◊ú ◊ê◊ú◊§◊ô ◊û◊ó◊ñ◊ï◊®◊ô ◊©◊¢◊ï◊ü ◊¢◊ú◊ï◊ú ◊ú◊î◊ô◊ï◊™ ◊î◊®◊°◊†◊ô ◊ë◊û◊ô◊ï◊ó◊ì ◊ë◊û◊¢◊®◊õ◊ï◊™ ◊ñ◊û◊ü ◊ê◊û◊™. ◊ë◊†◊ï◊°◊£, split locks ◊ô◊õ◊ï◊ú◊ô◊ù ◊ú◊©◊û◊© ◊õ◊õ◊ú◊ô ◊ú◊û◊™◊ß◊§◊™ DoS ◊ô◊¢◊ô◊ú◊î ◊î◊§◊ï◊í◊¢◊™ ◊ë◊õ◊ú ◊î◊û◊¢◊®◊õ◊™.</p>
<p>◊ë◊™◊®◊ó◊ô◊© ◊©◊ú ◊î◊™◊ß◊§◊î ◊ñ◊ì◊ï◊†◊ô◊™, ◊™◊ï◊õ◊†◊î ◊î◊®◊¶◊î ◊ë◊ú◊ï◊ú◊ê◊î ◊î◊ì◊ï◊ß◊î ◊ï◊û◊©◊™◊û◊©◊™ ◊ë-split lock ◊ô◊õ◊ï◊ú◊î ◊ú◊§◊í◊ï◊¢ ◊ß◊©◊ï◊™ ◊ë◊ë◊ô◊¶◊ï◊¢◊ô◊ù ◊©◊ú ◊î◊û◊¢◊®◊õ◊™ ◊õ◊ï◊ú◊î, ◊ï◊ú◊û◊¢◊©◊î ◊ú◊©◊ë◊© ◊ê◊™ ◊§◊¢◊ï◊ú◊™◊î ◊ë◊¶◊ï◊®◊î ◊û◊©◊û◊¢◊ï◊™◊ô◊™.</p>
<h3 id="◊î◊™◊û◊ï◊ì◊ì◊ï◊™-◊¢◊ù-◊î◊ë◊¢◊ô◊î-◊ë-linux">
  ◊î◊™◊û◊ï◊ì◊ì◊ï◊™ ◊¢◊ù ◊î◊ë◊¢◊ô◊î ◊ë-linux
  <a class="heading-link" href="#%d7%94%d7%aa%d7%9e%d7%95%d7%93%d7%93%d7%95%d7%aa-%d7%a2%d7%9d-%d7%94%d7%91%d7%a2%d7%99%d7%94-%d7%91-linux">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊î◊ó◊ú ◊û◊í◊®◊°◊î 5.19 ◊ë◊ß◊®◊†◊ú ◊©◊ú ◊ú◊ô◊†◊ï◊ß◊° ◊†◊ô◊™◊ü ◊ú◊î◊§◊¢◊ô◊ú ◊û◊†◊í◊†◊ï◊ü ◊ú◊ñ◊ô◊î◊ï◊ô ◊†◊¢◊ô◊ú◊ï◊™ bus ◊ê◊ï ◊†◊¢◊ô◊ú◊ï◊™ ◊î◊†◊í◊®◊û◊ï◊™ ◊û◊í◊ô◊©◊î split lock ◊ë◊ê◊û◊¶◊¢◊ï◊™ ◊î◊í◊ì◊®◊™ ◊î◊§◊®◊û◊ò◊® <code>split_lock_detect</code> ◊¢◊ù ◊î◊¢◊®◊ö ◊î◊û◊™◊ê◊ô◊ù.</p>
<p>◊õ◊ê◊©◊® ◊ñ◊ô◊î◊ï◊ô ◊ñ◊î ◊û◊ï◊§◊¢◊ú (◊ï◊ë◊û◊ô◊ì◊î ◊©◊ß◊ô◊ô◊û◊™ ◊™◊û◊ô◊õ◊î ◊ë◊ó◊ï◊û◊®◊î), ◊õ◊ú ◊î◊ï◊®◊ê◊î ◊ê◊ò◊ï◊û◊ô◊™ ◊î◊†◊ô◊í◊©◊™ ◊ú◊†◊™◊ï◊†◊ô◊ù ◊î◊ó◊ï◊¶◊ô◊ù ◊í◊ë◊ï◊ú◊ï◊™ ◊©◊ú ◊©◊ï◊®◊ï◊™ cache ◊™◊í◊®◊ï◊ù ◊ú◊ô◊¶◊ô◊®◊™ exception ◊©◊ú ◊ë◊ì◊ô◊ß◊™ ◊ô◊ô◊©◊ï◊® (alignment check exception) ◊ë◊û◊ß◊®◊î ◊©◊ú ◊ñ◊ô◊î◊ï◊ô split lock, ◊ê◊ï ◊ú-debug exception ◊ë◊û◊ß◊®◊î ◊©◊ú ◊ñ◊ô◊î◊ï◊ô ◊†◊¢◊ô◊ú◊™ bus.</p>
<p>◊ê◊ù ◊û◊†◊í◊†◊ï◊ü ◊î◊§◊ó◊™◊™ ◊î-split locks ◊û◊ï◊©◊ë◊™, ◊ô◊© ◊°◊ô◊õ◊ï◊ü ◊©-guests ◊ñ◊ì◊ï◊†◊ô◊ô◊ù ◊ë◊û◊õ◊ï◊†◊ï◊™ ◊ï◊ô◊®◊ò◊ï◊ê◊ú◊ô◊ï◊™ ◊ô◊ï◊õ◊ú◊ï ◊ú◊ë◊¶◊¢ ◊î◊™◊ß◊§◊ï◊™ DoS ◊†◊í◊ì ◊î-host ◊ê◊ï ◊†◊í◊ì guests ◊ê◊ó◊®◊ô◊ù, ◊ì◊ë◊® ◊©◊¢◊ú◊ï◊ú ◊ú◊î◊©◊§◊ô◊¢ ◊ú◊®◊¢◊î ◊¢◊ú ◊ô◊¶◊ô◊ë◊ï◊™ ◊ï◊ë◊ô◊¶◊ï◊¢◊ô ◊î◊û◊¢◊®◊õ◊™.</p>
<p>◊ú◊§◊®◊û◊ò◊® <code>split_lock_detect</code> ◊ô◊© ◊û◊°◊§◊® ◊¢◊®◊õ◊ô◊ù ◊©◊†◊ô◊™◊ü ◊ú◊ß◊ë◊ï◊¢ ◊ï◊õ◊ú ◊ê◊ó◊ì ◊ô◊í◊®◊ï◊ù ◊ú◊î◊™◊†◊î◊í◊ï◊™ ◊©◊ï◊†◊î:</p>
<ul>
<li>
<p>◊õ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú ◊©◊û◊í◊ô◊¢ ◊ë◊û◊¶◊ë <code>warn</code>, ◊™◊î◊ú◊ô◊õ◊ô◊ù ◊î◊û◊ë◊¶◊¢◊ô◊ù split lock ◊†◊¢◊†◊©◊ô◊ù ◊¢◊ú ◊ô◊ì◊ô ◊î◊ê◊ò◊™ ◊ë◊ô◊¶◊ï◊¢◊ô◊î◊ù, ◊ê◊ö ◊ê◊ô◊†◊ù ◊†◊î◊®◊í◊ô◊ù. ◊õ◊ê◊©◊® ◊û◊™◊ë◊¶◊¢◊™ ◊†◊¢◊ô◊ú◊î ◊û◊§◊ï◊¶◊ú◊™, ◊î◊ß◊®◊†◊ú ◊ô◊ï◊¶◊® ◊¢◊ô◊õ◊ï◊ë ◊©◊ú 10 ◊ê◊ú◊§◊ô◊ï◊™ ◊©◊†◊ô◊ô◊î ◊ï◊û◊ë◊¶◊¢◊™ ◊î◊°◊ì◊®◊î (serialization) ◊©◊ú ◊î◊™◊î◊ú◊ô◊ö ◊ë◊ê◊û◊¶◊¢◊ï◊™ semaphore ◊î◊™◊î◊ú◊ô◊õ◊ô◊ù ◊î◊ê◊ó◊®◊ô◊ù ◊©◊í◊ù ◊í◊ï◊®◊û◊ô◊ù ◊ú-split locks. ◊ë◊û◊¶◊ë ◊ñ◊î, ◊ê◊ù ◊™◊ï◊õ◊†◊î ◊ñ◊ì◊ï◊†◊ô◊™ ◊û◊†◊°◊î ◊ú◊†◊¶◊ú ◊†◊¢◊ô◊ú◊ï◊™ ◊û◊§◊ï◊¶◊ú◊ï◊™, ◊î◊ô◊ê ◊™◊í◊®◊ï◊ù ◊ú◊î◊ê◊ò◊î ◊ë◊¢◊¶◊û◊î, ◊ê◊ö ◊î◊©◊§◊¢◊™◊î ◊¢◊ú ◊©◊ê◊® ◊î◊û◊¢◊®◊õ◊™ ◊™◊î◊ô◊î ◊û◊ô◊†◊ô◊û◊ú◊ô◊™.
◊î◊ß◊ï◊ì ◊©◊û◊ë◊¶◊¢ ◊ê◊™ ◊ñ◊î ◊†◊û◊¶◊ê ◊ë-<code>arch/x86/kernel/cpu/intel.c</code> ◊ë◊§◊ï◊†◊ß◊¶◊ô◊î <code>split_lock_warn</code> (<a href="https://elixir.bootlin.com/linux/v6.10/source/arch/x86/kernel/cpu/intel.c#L1145"  class="external-link" target="_blank" rel="noopener">◊ß◊ô◊©◊ï◊® ◊ú◊ß◊ï◊ì</a>).</p>
</li>
<li>
<p>◊†◊ô◊™◊ü ◊ú◊î◊í◊ì◊ô◊® ◊©◊™◊î◊ú◊ô◊õ◊ô ◊û◊©◊™◊û◊© ◊©◊û◊†◊°◊ô◊ù ◊ú◊ë◊¶◊¢ ◊§◊¢◊ï◊ú◊î ◊©◊ú split lock ◊ô◊ß◊ë◊ú◊ï ◊ê◊™ ◊ê◊ï◊™ ◊î-<code>SIGBUS</code>.</p>
</li>
</ul>
<p>◊ô◊© ◊¢◊ï◊ì ◊¢◊®◊õ◊ô◊ù ◊©◊†◊ô◊™◊ü ◊ú◊î◊¢◊ë◊ô◊® ◊ú◊§◊®◊û◊ò◊® ◊ï◊ê◊§◊©◊® ◊ú◊ß◊®◊ï◊ê ◊¢◊ú◊ô◊î◊ù <a href="https://docs.kernel.org/arch/x86/buslock.html"  class="external-link" target="_blank" rel="noopener">◊ë◊™◊ô◊¢◊ï◊ì ◊©◊ú ◊î◊ß◊®◊†◊ú</a>.</p>
<p>◊õ◊ì◊ô ◊ú◊ë◊ò◊ú ◊ê◊™ ◊î◊î◊ê◊ò◊î ◊ú◊ê ◊ë◊ê◊ï◊§◊ü ◊ß◊ë◊ï◊¢ ◊ê◊§◊©◊® ◊ú◊©◊†◊ï◊™ ◊ê◊™ ◊î◊¢◊®◊ö ◊©◊ú <code>/proc/sys/kernel/split_lock_mitigate</code>, ◊¢◊®◊ö <code>0</code> ◊®◊ß ◊û◊ñ◊î◊ô◊® ◊ú◊í◊ë◊ô split lock ◊ï◊¢◊®◊ö <code>1</code> ◊û◊ë◊¶◊¢ ◊ê◊™ ◊î◊¢◊ï◊†◊© ◊ï◊û◊ê◊ò ◊ê◊™ ◊î◊™◊î◊ú◊ô◊õ◊ô◊ù ◊î◊°◊ï◊®◊®◊ô◊ù.</p>
<h2 id="ordering">
  ordering
  <a class="heading-link" href="#ordering">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>◊õ◊ú ◊î◊ï◊®◊ê◊î ◊¢◊ù lock prefix, ◊õ◊û◊ï <code>xchg</code>, ◊§◊ï◊¢◊ú◊™ ◊í◊ù ◊õ◊û◊ó◊°◊ï◊ù ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊ú◊ê. ◊ñ◊ê◊™ ◊ë◊™◊†◊ê◊ô ◊©◊ú◊ê ◊†◊¢◊©◊î ◊©◊ô◊û◊ï◊© ◊ë◊î◊ï◊®◊ê◊ï◊™ SSE ◊ê◊ï ◊ë◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊°◊ï◊í write-combined.</p>
<p>◊ë◊ë◊ô◊¶◊ï◊¢ ◊§◊¢◊ï◊ú◊î ◊¢◊ù lock ◊®◊ß ◊ú◊ê◊ó◊® ◊©◊õ◊ú ◊§◊¢◊ï◊ú◊ï◊™ ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊ß◊ï◊ì◊û◊ï◊™ ◊î◊ï◊©◊ú◊û◊ï, ◊î◊û◊¢◊ë◊ì ◊ô◊™◊ó◊ô◊ú ◊ú◊ë◊¶◊¢ ◊ê◊™ ◊§◊¢◊ï◊ú◊ï◊™ ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊†◊ì◊®◊©◊ï◊™ ◊¢◊ú ◊ô◊ì◊ô ◊î◊î◊ï◊®◊ê◊ï◊™ ◊©◊¢◊ï◊ß◊ë◊ï◊™ ◊ê◊ó◊®◊ô ◊î◊î◊ï◊®◊ê◊î ◊¢◊ù ◊î-lock.</p>
<p>◊ë◊û◊ô◊ú◊ô◊ù ◊ê◊ó◊®◊ï◊™, ◊î-lock prefix ◊û◊ë◊ò◊ô◊ó ◊©◊î◊û◊¢◊ë◊ì ◊ô◊†◊î◊ú ◊ê◊™ ◊°◊ì◊® ◊î◊ë◊ô◊¶◊ï◊¢ ◊©◊ú ◊§◊¢◊ï◊ú◊ï◊™ ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊ß◊©◊ï◊®◊ï◊™ ◊ú◊î◊ï◊®◊ê◊î ◊î◊ê◊ò◊ï◊û◊ô◊™, ◊ë◊õ◊ö ◊©◊î◊ô◊ê ◊û◊ï◊ï◊ì◊ê◊™ ◊©◊õ◊ú ◊§◊¢◊ï◊ú◊ï◊™ ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊ß◊ï◊ì◊û◊ï◊™ ◊î◊ï◊©◊ú◊û◊ï ◊ß◊ï◊ì◊ù ◊ú◊î◊ó◊ú◊î ◊©◊ú ◊§◊¢◊ï◊ú◊ï◊™ ◊î◊ñ◊ô◊õ◊®◊ï◊ü ◊î◊ë◊ê◊ï◊™. ◊ê◊§◊©◊® ◊ú◊ó◊©◊ï◊ë ◊¢◊ú ◊ñ◊î ◊ë◊™◊ï◊® ◊î◊û◊™◊†◊î ◊©◊ú ◊î◊û◊¢◊ë◊ì ◊©◊û◊ó◊õ◊î ◊©◊î-store buffer ◊ô◊™◊®◊ï◊ß◊ü (◊ë◊û◊¶◊ô◊ê◊ï◊™ ◊ñ◊î ◊î◊®◊ë◊î ◊ô◊ï◊™◊® ◊û◊ï◊®◊õ◊ë ◊õ◊ô ◊ô◊© ◊¢◊ï◊ì ◊î◊®◊ë◊î ◊û◊ê◊ï◊ì ◊í◊ï◊®◊û◊ô◊ù ◊ú◊ë◊ô◊¶◊ï◊¢ out-of-order).</p>
<p>◊î◊î◊™◊†◊î◊í◊ï◊™ ◊î◊ñ◊ê◊™ ◊ô◊õ◊ï◊ú◊î ◊ú◊î◊©◊™◊†◊ï◊™ ◊ï◊ú◊õ◊ü ◊ê◊ù ◊¶◊®◊ô◊ö ◊°◊ì◊® ◊ñ◊ô◊õ◊®◊ï◊ü ◊¶◊®◊ô◊ö ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊ó◊°◊ï◊û◊ô◊ù ◊û◊™◊ê◊ô◊û◊ô◊ù ◊õ◊û◊ï <code>mfence</code>.</p>

      </div>


      <footer>
        
  <h3 dir="rtl">
    ◊û◊ß◊ï◊®◊ï◊™
  </h3>
  <ul dir="ltr">
  
    <li>
      <a href="https://docs.kernel.org/arch/x86/buslock.html">https://docs.kernel.org/arch/x86/buslock.html</a>
    </li>
  
    <li>
      <a href="https://lwn.net/Articles/806466/">https://lwn.net/Articles/806466/</a>
    </li>
  
    <li>
      <a href="https://lwn.net/Articles/911219/">https://lwn.net/Articles/911219/</a>
    </li>
  
    <li>
      <a href="https://docs.kernel.org/arch/x86/buslock.html">https://docs.kernel.org/arch/x86/buslock.html</a>
    </li>
  
    <li>
      <a href="https://pve.proxmox.com/wiki/Split_lock_detection">https://pve.proxmox.com/wiki/Split_lock_detection</a>
    </li>
  
    <li>
      <a href="https://www.kernel.org/doc/html/latest/admin-guide/sysctl/kernel.html#split-lock-mitigate-x86-only">https://www.kernel.org/doc/html/latest/admin-guide/sysctl/kernel.html#split-lock-mitigate-x86-only</a>
    </li>
  
    <li>
      <a href="https://x86.lol/generic/2023/11/07/split-lock.html">https://x86.lol/generic/2023/11/07/split-lock.html</a>
    </li>
  
    <li>
      <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-kememorybarrier">https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-kememorybarrier</a>
    </li>
  
    <li>
      <a href="https://preshing.com/20120515/memory-reordering-caught-in-the-act/">https://preshing.com/20120515/memory-reordering-caught-in-the-act/</a>
    </li>
  
    <li>
      <a href="https://www.amd.com/content/dam/amd/en/documents/processor-tech-docs/programmer-references/24593.pdf">https://www.amd.com/content/dam/amd/en/documents/processor-tech-docs/programmer-references/24593.pdf</a>
    </li>
  
    <li>
      <a href="https://c9x.me/x86/html/file_module_x86_id_159.html">https://c9x.me/x86/html/file_module_x86_id_159.html</a>
    </li>
  
    <li>
      <a href="https://cdrdv2-public.intel.com/825743/325462-sdm-vol-1-2abcd-3abcd-4.pdf">https://cdrdv2-public.intel.com/825743/325462-sdm-vol-1-2abcd-3abcd-4.pdf</a>
    </li>
  

        

<section class="see-also">
  
    
    
    
      <h3 id="◊®◊ï◊ê◊î-◊¢◊ï◊ì-◊ë-atomic" dir="rtl">        ◊®◊ï◊ê◊î ◊¢◊ï◊ì ◊ë atomic
        <a class="heading-link" href="#%d7%a8%d7%95%d7%90%d7%94-%d7%a2%d7%95%d7%93-%d7%91-atomic">
          <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
          <span class="sr-only">Link to heading</span>
        </a>
      </h3>
      <nav>
        <ul>
        
        
          
        
          
            <li>
              <a href="/he/posts/atomic/exclusive/">Exclusive</a>
            </li>
          
        
          
            <li>
              <a href="/he/posts/atomic/atomic/">Atomic</a>
            </li>
          
        
        </ul>
      </nav>
    
  
</section>


        
        
        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script><style>
  .katex {
    direction: ltr;
    display: inline-flex;
    flex-direction: row-reverse;
    unicode-bidi: embed;
  }
</style>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ¬©
    
    2025
     Michael Shalitin 
    ¬∑
    
    ◊û◊ï◊§◊¢◊ú ◊¢◊ú ◊ô◊ì◊ô <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  
<script defer src='https://static.cloudflareinsights.com/beacon.min.js'
        data-cf-beacon='{"token": "316bf5f2576c4cb68b54c0b2a91cb739"}'></script>



  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
