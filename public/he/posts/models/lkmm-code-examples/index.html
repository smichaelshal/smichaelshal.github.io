<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <title>
  LKMM Code Examples ¬∑ Michael Shalitin
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">


<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://www.youtube.com; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' default-src 'unsafe-eval' https://www.google-analytics.com https://cdn.jsdelivr.net/ https://static.cloudflareinsights.com https://cloudflareinsights.com; connect-src 'self' https://www.google-analytics.com https://static.cloudflareinsights.com https://cloudflareinsights.com;">




<meta name="author" content="Michael Shalitin">
<meta name="description" content="
  ◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù
  
    
    Link to heading
  

◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊©◊ô◊ú◊ï◊ë ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù ◊û◊ê◊§◊©◊® ◊î◊™◊û◊ï◊ì◊ì◊ï◊™ ◊¢◊ù ◊ë◊¢◊ô◊ï◊™ ◊°◊ô◊†◊õ◊®◊ï◊ü ◊ë◊¶◊ï◊®◊î ◊ô◊¢◊ô◊ú◊î ◊ô◊ï◊™◊®, ◊™◊ï◊ö ◊î◊ô◊û◊†◊¢◊ï◊™ ◊û◊î◊¶◊ï◊®◊ö ◊ë◊û◊†◊í◊†◊ï◊†◊ô◊ù ◊õ◊ë◊ì◊ô◊ù ◊õ◊û◊ï:


◊î◊û◊†◊¢◊ï◊™ ◊û◊†◊¢◊ô◊ú◊î: ◊ë◊û◊ß◊ï◊ù ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú ◊©◊©◊ï◊ú◊ò ◊¢◊ú ◊©◊†◊ô ◊î◊ß◊¶◊ï◊ï◊™ ◊©◊ú ◊î-buffer (◊î◊ß◊¶◊î ◊©◊ú ◊î◊õ◊™◊ô◊ë◊î ◊ï◊î◊ß◊¶◊î ◊©◊ú ◊î◊ß◊®◊ô◊ê◊î), ◊†◊ô◊™◊ü ◊ú◊ê◊§◊©◊® ◊í◊ô◊©◊î ◊ë◊ï-◊ñ◊û◊†◊ô◊™ ◊ú◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù. ◊õ◊ö ◊î◊ô◊¶◊®◊ü ◊ô◊õ◊ï◊ú ◊ú◊î◊õ◊†◊ô◊° ◊†◊™◊ï◊†◊ô◊ù ◊ú-buffer ◊ë◊ï ◊ñ◊û◊†◊ô◊™ ◊¢◊ù ◊î◊¶◊®◊õ◊ü ◊©◊û◊ï◊¶◊ô◊ê ◊†◊™◊ï◊†◊ô◊ù ◊û◊û◊†◊ï, ◊û◊ë◊ú◊ô ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú.">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="LKMM Code Examples">
  <meta name="twitter:description" content="◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù Link to heading ◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊©◊ô◊ú◊ï◊ë ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù ◊û◊ê◊§◊©◊® ◊î◊™◊û◊ï◊ì◊ì◊ï◊™ ◊¢◊ù ◊ë◊¢◊ô◊ï◊™ ◊°◊ô◊†◊õ◊®◊ï◊ü ◊ë◊¶◊ï◊®◊î ◊ô◊¢◊ô◊ú◊î ◊ô◊ï◊™◊®, ◊™◊ï◊ö ◊î◊ô◊û◊†◊¢◊ï◊™ ◊û◊î◊¶◊ï◊®◊ö ◊ë◊û◊†◊í◊†◊ï◊†◊ô◊ù ◊õ◊ë◊ì◊ô◊ù ◊õ◊û◊ï:
◊î◊û◊†◊¢◊ï◊™ ◊û◊†◊¢◊ô◊ú◊î: ◊ë◊û◊ß◊ï◊ù ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú ◊©◊©◊ï◊ú◊ò ◊¢◊ú ◊©◊†◊ô ◊î◊ß◊¶◊ï◊ï◊™ ◊©◊ú ◊î-buffer (◊î◊ß◊¶◊î ◊©◊ú ◊î◊õ◊™◊ô◊ë◊î ◊ï◊î◊ß◊¶◊î ◊©◊ú ◊î◊ß◊®◊ô◊ê◊î), ◊†◊ô◊™◊ü ◊ú◊ê◊§◊©◊® ◊í◊ô◊©◊î ◊ë◊ï-◊ñ◊û◊†◊ô◊™ ◊ú◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù. ◊õ◊ö ◊î◊ô◊¶◊®◊ü ◊ô◊õ◊ï◊ú ◊ú◊î◊õ◊†◊ô◊° ◊†◊™◊ï◊†◊ô◊ù ◊ú-buffer ◊ë◊ï ◊ñ◊û◊†◊ô◊™ ◊¢◊ù ◊î◊¶◊®◊õ◊ü ◊©◊û◊ï◊¶◊ô◊ê ◊†◊™◊ï◊†◊ô◊ù ◊û◊û◊†◊ï, ◊û◊ë◊ú◊ô ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú.">

<meta property="og:url" content="https://smichaelshal.github.io/he/posts/models/lkmm-code-examples/">
  <meta property="og:site_name" content="Michael Shalitin">
  <meta property="og:title" content="LKMM Code Examples">
  <meta property="og:description" content="◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù Link to heading ◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊©◊ô◊ú◊ï◊ë ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù ◊û◊ê◊§◊©◊® ◊î◊™◊û◊ï◊ì◊ì◊ï◊™ ◊¢◊ù ◊ë◊¢◊ô◊ï◊™ ◊°◊ô◊†◊õ◊®◊ï◊ü ◊ë◊¶◊ï◊®◊î ◊ô◊¢◊ô◊ú◊î ◊ô◊ï◊™◊®, ◊™◊ï◊ö ◊î◊ô◊û◊†◊¢◊ï◊™ ◊û◊î◊¶◊ï◊®◊ö ◊ë◊û◊†◊í◊†◊ï◊†◊ô◊ù ◊õ◊ë◊ì◊ô◊ù ◊õ◊û◊ï:
◊î◊û◊†◊¢◊ï◊™ ◊û◊†◊¢◊ô◊ú◊î: ◊ë◊û◊ß◊ï◊ù ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú ◊©◊©◊ï◊ú◊ò ◊¢◊ú ◊©◊†◊ô ◊î◊ß◊¶◊ï◊ï◊™ ◊©◊ú ◊î-buffer (◊î◊ß◊¶◊î ◊©◊ú ◊î◊õ◊™◊ô◊ë◊î ◊ï◊î◊ß◊¶◊î ◊©◊ú ◊î◊ß◊®◊ô◊ê◊î), ◊†◊ô◊™◊ü ◊ú◊ê◊§◊©◊® ◊í◊ô◊©◊î ◊ë◊ï-◊ñ◊û◊†◊ô◊™ ◊ú◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù. ◊õ◊ö ◊î◊ô◊¶◊®◊ü ◊ô◊õ◊ï◊ú ◊ú◊î◊õ◊†◊ô◊° ◊†◊™◊ï◊†◊ô◊ù ◊ú-buffer ◊ë◊ï ◊ñ◊û◊†◊ô◊™ ◊¢◊ù ◊î◊¶◊®◊õ◊ü ◊©◊û◊ï◊¶◊ô◊ê ◊†◊™◊ï◊†◊ô◊ù ◊û◊û◊†◊ï, ◊û◊ë◊ú◊ô ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú.">
  <meta property="og:locale" content="he">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-12-12T00:00:00+00:00">
    <meta property="article:tag" content="Cpu">
    <meta property="article:tag" content="Memory">
    <meta property="article:tag" content="Cache">
    <meta property="article:tag" content="Ordering">
    <meta property="article:tag" content="Lkmm">
    <meta property="article:tag" content="Kernel">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/models/lkmm/">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/models/dependency/">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/models/herd7/">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/models/models/">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/models/base-formal/">
      <meta property="og:see_also" content="https://smichaelshal.github.io/he/posts/models/ordering/">




<link rel="canonical" href="https://smichaelshal.github.io/he/posts/models/lkmm-code-examples/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.6c967191184c40e901e41977158c33a73a2cfa2d9413cf73dddd6732eeae7af4.css" integrity="sha256-bJZxkRhMQOkB5Bl3FYwzpzos&#43;i2UE89z3d1nMu6uevQ=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://smichaelshal.github.io/he/">
      Michael Shalitin
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/he/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/he/posts/">Blog</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/posts/models/lkmm-code-examples/">üá¨üáß</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://smichaelshal.github.io/he/posts/models/lkmm-code-examples/">
              LKMM Code Examples
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-12-12T00:00:00Z">
                ◊ì◊¶◊û◊ë◊® 12, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-newspaper" aria-hidden="true"></i>
                1687 ◊û◊ô◊ú◊ô◊ù
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/he/categories/memory-models/">Memory-Models</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/he/tags/cpu/">Cpu</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/memory/">Memory</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/cache/">Cache</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/ordering/">Ordering</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/lkmm/">Lkmm</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/kernel/">Kernel</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/linux/">Linux</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/barrier/">Barrier</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/memory-model/">Memory-Model</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/formal/">Formal</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/litmus/">Litmus</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/cat/">Cat</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/bell/">Bell</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/lock/">Lock</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/buffer/">Buffer</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="/he/tags/release-acquire/">Release-Acquire</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <h2 id="◊©◊ô◊û◊ï◊©-◊ë◊û◊ó◊°◊ï◊û◊ô-◊ñ◊ô◊õ◊®◊ï◊ü-◊¢◊ù-buffer-◊ô◊ù-◊û◊¢◊í◊ú◊ô◊ô◊ù">
  ◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù
  <a class="heading-link" href="#%d7%a9%d7%99%d7%9e%d7%95%d7%a9-%d7%91%d7%9e%d7%97%d7%a1%d7%95%d7%9e%d7%99-%d7%96%d7%99%d7%9b%d7%a8%d7%95%d7%9f-%d7%a2%d7%9d-buffer-%d7%99%d7%9d-%d7%9e%d7%a2%d7%92%d7%9c%d7%99%d7%99%d7%9d">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊©◊ô◊ú◊ï◊ë ◊¢◊ù buffer-◊ô◊ù ◊û◊¢◊í◊ú◊ô◊ô◊ù ◊û◊ê◊§◊©◊® ◊î◊™◊û◊ï◊ì◊ì◊ï◊™ ◊¢◊ù ◊ë◊¢◊ô◊ï◊™ ◊°◊ô◊†◊õ◊®◊ï◊ü ◊ë◊¶◊ï◊®◊î ◊ô◊¢◊ô◊ú◊î ◊ô◊ï◊™◊®, ◊™◊ï◊ö ◊î◊ô◊û◊†◊¢◊ï◊™ ◊û◊î◊¶◊ï◊®◊ö ◊ë◊û◊†◊í◊†◊ï◊†◊ô◊ù ◊õ◊ë◊ì◊ô◊ù ◊õ◊û◊ï:</p>
<ul>
<li>
<p><strong>◊î◊û◊†◊¢◊ï◊™ ◊û◊†◊¢◊ô◊ú◊î:</strong> ◊ë◊û◊ß◊ï◊ù ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú ◊©◊©◊ï◊ú◊ò ◊¢◊ú ◊©◊†◊ô ◊î◊ß◊¶◊ï◊ï◊™ ◊©◊ú ◊î-buffer (◊î◊ß◊¶◊î ◊©◊ú ◊î◊õ◊™◊ô◊ë◊î ◊ï◊î◊ß◊¶◊î ◊©◊ú ◊î◊ß◊®◊ô◊ê◊î), ◊†◊ô◊™◊ü ◊ú◊ê◊§◊©◊® ◊í◊ô◊©◊î ◊ë◊ï-◊ñ◊û◊†◊ô◊™ ◊ú◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù. ◊õ◊ö ◊î◊ô◊¶◊®◊ü ◊ô◊õ◊ï◊ú ◊ú◊î◊õ◊†◊ô◊° ◊†◊™◊ï◊†◊ô◊ù ◊ú-buffer ◊ë◊ï ◊ñ◊û◊†◊ô◊™ ◊¢◊ù ◊î◊¶◊®◊õ◊ü ◊©◊û◊ï◊¶◊ô◊ê ◊†◊™◊ï◊†◊ô◊ù ◊û◊û◊†◊ï, ◊û◊ë◊ú◊ô ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊†◊¢◊ï◊ú.</p>
</li>
<li>
<p><strong>◊î◊û◊†◊¢◊ï◊™ ◊û-counter ◊ê◊ò◊ï◊û◊ô:</strong> ◊ê◊ô◊ü ◊¶◊ï◊®◊ö ◊ú◊î◊©◊™◊û◊© ◊ë◊§◊¢◊ï◊ú◊ï◊™ ◊û◊ï◊†◊î ◊ê◊ò◊ï◊û◊ô◊ï◊™ ◊ú◊†◊ô◊î◊ï◊ú ◊û◊¶◊ë ◊î-buffer (◊õ◊í◊ï◊ü ◊°◊§◊ô◊®◊™ ◊û◊°◊§◊® ◊î◊§◊®◊ô◊ò◊ô◊ù ◊ê◊ï ◊û◊¢◊ß◊ë ◊ê◊ó◊®◊ô ◊î◊û◊ô◊ß◊ï◊ù ◊î◊†◊ï◊õ◊ó◊ô ◊ú◊õ◊™◊ô◊ë◊î ◊ï◊ú◊ß◊®◊ô◊ê◊î).</p>
</li>
</ul>
<h3 id="◊ó◊ú◊ï◊ß◊™-◊™◊§◊ß◊ô◊ì◊ô◊ù">
  ◊ó◊ú◊ï◊ß◊™ ◊™◊§◊ß◊ô◊ì◊ô◊ù
  <a class="heading-link" href="#%d7%97%d7%9c%d7%95%d7%a7%d7%aa-%d7%aa%d7%a4%d7%a7%d7%99%d7%93%d7%99%d7%9d">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊ë◊û◊†◊í◊†◊ï◊ü ◊ñ◊î ◊ô◊©◊†◊î ◊î◊§◊®◊ì◊î ◊ë◊ô◊ü ◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù:</p>
<ol>
<li><strong>◊î◊ô◊¶◊®◊ü (Producer):</strong> ◊ê◊ó◊®◊ê◊ô ◊¢◊ú ◊û◊ô◊ú◊ï◊ô ◊î-buffer ◊¢◊ú ◊ô◊ì◊ô ◊î◊ï◊°◊§◊™ ◊†◊™◊ï◊†◊ô◊ù ◊ó◊ì◊©◊ô◊ù.</li>
<li><strong>◊î◊¶◊®◊õ◊ü (Consumer):</strong> ◊ê◊ó◊®◊ê◊ô ◊¢◊ú ◊®◊ô◊ß◊ï◊ü ◊î-buffer ◊¢◊ú ◊ô◊ì◊ô ◊ß◊®◊ô◊ê◊î ◊ï◊î◊ï◊¶◊ê◊™ ◊î◊†◊™◊ï◊†◊ô◊ù.</li>
</ol>
<h3 id="◊¢◊ß◊®◊ï◊†◊ï◊™-◊§◊¢◊ï◊ú◊î">
  ◊¢◊ß◊®◊ï◊†◊ï◊™ ◊§◊¢◊ï◊ú◊î:
  <a class="heading-link" href="#%d7%a2%d7%a7%d7%a8%d7%95%d7%a0%d7%95%d7%aa-%d7%a4%d7%a2%d7%95%d7%9c%d7%94">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊ë◊õ◊ú ◊ñ◊û◊ü ◊†◊™◊ï◊ü, ◊ë◊¶◊ì ◊û◊°◊ï◊ô◊ô◊ù (◊î◊ô◊¶◊®◊ü ◊ê◊ï ◊î◊¶◊®◊õ◊ü) ◊®◊ß ◊ê◊ó◊ì ◊ô◊õ◊ï◊ú ◊ú◊§◊¢◊ï◊ú ◊¢◊ú ◊î-buffer ◊ë◊ê◊ï◊™◊ï ◊õ◊ô◊ï◊ï◊ü - ◊ê◊ï ◊î◊ï◊°◊§◊î ◊©◊ú ◊†◊™◊ï◊†◊ô◊ù ◊ê◊ï ◊ß◊®◊ô◊ê◊î ◊ï◊î◊ï◊¶◊ê◊î, ◊õ◊ú◊ï◊û◊® ◊¢◊ú ◊û◊†◊™ ◊ú◊î◊©◊™◊û◊© ◊ë◊û◊°◊§◊® ◊ô◊¶◊®◊†◊ô◊ù ◊ê◊ï ◊¶◊®◊õ◊†◊ô◊ù ◊¶◊®◊ô◊ö ◊û◊†◊í◊†◊ï◊ü ◊ê◊ó◊ì ◊õ◊û◊ï ◊†◊¢◊ô◊ú◊î.</p>
<p>◊¢◊ù ◊ñ◊ê◊™, ◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù ◊ô◊õ◊ï◊ú◊ô◊ù ◊ú◊¢◊ë◊ï◊ì ◊ë◊û◊ß◊ë◊ô◊ú, ◊õ◊ú◊ï◊û◊® ◊î◊ô◊¶◊®◊ü ◊ô◊õ◊ï◊ú ◊ú◊î◊ï◊°◊ô◊£ ◊†◊™◊ï◊†◊ô◊ù ◊ë◊ñ◊û◊ü ◊©◊î◊¶◊®◊õ◊ü ◊û◊ï◊¶◊ô◊ê ◊†◊™◊ï◊†◊ô◊ù - ◊ñ◊ê◊™ ◊û◊ë◊ú◊ô ◊©◊ô◊§◊®◊ô◊¢◊ï ◊ñ◊î ◊ú◊ñ◊î.</p>
<p>◊©◊ô◊û◊ï◊© ◊ë◊û◊ó◊°◊ï◊û◊ô ◊ñ◊ô◊õ◊®◊ï◊ü ◊û◊ë◊ò◊ô◊ó ◊©◊°◊ì◊® ◊î◊§◊¢◊ï◊ú◊ï◊™ ◊ô◊™◊ë◊¶◊¢ ◊ë◊ê◊ï◊§◊ü ◊©◊™◊ï◊ê◊ù ◊ê◊™ ◊ì◊®◊ô◊©◊ï◊™ ◊î◊°◊ì◊® ◊ï◊î◊¢◊ß◊ô◊ë◊ï◊™ ◊©◊ú ◊î◊ê◊®◊õ◊ô◊ò◊ß◊ò◊ï◊®◊î, ◊û◊ë◊ú◊ô ◊ú◊î◊ñ◊ì◊ß◊ß ◊ú◊§◊¢◊ï◊ú◊ï◊™ ◊°◊ô◊†◊õ◊®◊ï◊ü ◊ô◊ß◊®◊ï◊™ ◊õ◊û◊ï ◊†◊¢◊ô◊ú◊ï◊™ ◊ê◊ï ◊û◊ï◊†◊ô◊ù ◊ê◊ò◊ï◊û◊ô◊ô◊ù.</p>
<h3 id="◊î-producer">
  ◊î-producer
  <a class="heading-link" href="#%d7%94-producer">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊î◊ô◊¶◊®◊ü ◊ô◊ô◊®◊ê◊î ◊ë◊¢◊®◊ö ◊õ◊ö:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nf">spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">producer_lock</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">head</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">-&gt;</span><span class="n">head</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm">/* The spin_unlock() and next spin_lock() provide needed ordering. */</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tail</span> <span class="o">=</span> <span class="nf">READ_ONCE</span><span class="p">(</span><span class="n">buffer</span><span class="o">-&gt;</span><span class="n">tail</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">CIRC_SPACE</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">buffer</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="cm">/* insert one item into the buffer */</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">struct</span> <span class="n">item</span> <span class="o">*</span><span class="n">item</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="n">head</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="nf">produce_item</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="nf">smp_store_release</span><span class="p">(</span><span class="n">buffer</span><span class="o">-&gt;</span><span class="n">head</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">                          <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">buffer</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="cm">/* wake_up() will make sure that the head is committed before waking anyone up */</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="nf">wake_up</span><span class="p">(</span><span class="n">consumer</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="nf">spin_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">producer_lock</span><span class="p">);</span>
</span></span></code></pre></div><p>◊î◊§◊ï◊†◊ß◊¶◊ô◊î <code>wake_up()</code>  ◊ú◊§◊†◊ô ◊©◊î◊ô◊ê ◊û◊¢◊ô◊®◊î ◊™◊î◊ú◊ô◊õ◊ô◊ù ◊ê◊ó◊®◊ô◊ù ◊©◊ô◊õ◊ï◊ú◊ô◊ù ◊ú◊í◊©◊™ ◊ú-buffer, ◊î◊ô◊ê ◊û◊ë◊ò◊ô◊ó◊î ◊©◊î◊¢◊ì◊õ◊ï◊ü ◊ú◊û◊©◊™◊†◊î <code>head</code> (◊ê◊ï ◊ú◊õ◊ú ◊û◊©◊™◊†◊î ◊ê◊ó◊® ◊î◊û◊ô◊ô◊¶◊í ◊ê◊™ ◊†◊ß◊ï◊ì◊™ ◊î◊î◊ï◊°◊§◊î ◊©◊ú ◊î◊†◊™◊ï◊†◊ô◊ù ◊ë-buffer) ◊î◊ï◊©◊ú◊ù ◊ï◊†◊õ◊™◊ë ◊ú◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊¶◊ï◊®◊î ◊û◊ú◊ê◊î.</p>
<h4 id="◊°◊ì◊®-◊õ◊™◊ô◊ë◊î-◊ú◊ñ◊ô◊õ◊®◊ï◊ü-◊¢◊ú-◊ô◊ì◊ô-◊î◊û◊¢◊ë◊ì">
  ◊°◊ì◊® ◊õ◊™◊ô◊ë◊î ◊ú◊ñ◊ô◊õ◊®◊ï◊ü ◊¢◊ú ◊ô◊ì◊ô ◊î◊û◊¢◊ë◊ì
  <a class="heading-link" href="#%d7%a1%d7%93%d7%a8-%d7%9b%d7%aa%d7%99%d7%91%d7%94-%d7%9c%d7%96%d7%99%d7%9b%d7%a8%d7%95%d7%9f-%d7%a2%d7%9c-%d7%99%d7%93%d7%99-%d7%94%d7%9e%d7%a2%d7%91%d7%93">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>◊õ◊ê◊©◊® ◊§◊®◊ô◊ò ◊ó◊ì◊© ◊û◊™◊ï◊ï◊°◊£ ◊ú-buffer ◊î◊û◊¢◊í◊ú◊ô, ◊†◊ì◊®◊© ◊ú◊î◊ß◊§◊ô◊ì ◊¢◊ú ◊°◊ì◊® ◊û◊°◊ï◊ô◊ù ◊©◊ú ◊§◊¢◊ï◊ú◊ï◊™ ◊õ◊™◊ô◊ë◊î ◊ú◊ñ◊ô◊õ◊®◊ï◊ü, ◊õ◊ì◊ô ◊ú◊©◊û◊ï◊® ◊¢◊ú ◊¢◊ß◊ë◊ô◊ï◊™ ◊ï◊ñ◊û◊ô◊†◊ï◊™ ◊î◊†◊™◊ï◊†◊ô◊ù ◊¢◊ë◊ï◊® ◊î◊¶◊®◊õ◊ü:</p>
<ol>
<li>
<p><strong>◊õ◊™◊ô◊ë◊™ ◊î◊§◊®◊ô◊ò:</strong> ◊î◊û◊¢◊ë◊ì ◊û◊ß◊ë◊ú ◊î◊ï◊®◊ê◊î ◊ú◊õ◊™◊ï◊ë ◊ß◊ï◊ì◊ù ◊õ◊ú ◊ê◊™ ◊™◊ï◊õ◊ü ◊î◊§◊®◊ô◊ò ◊î◊ó◊ì◊© ◊ú◊ñ◊ô◊õ◊®◊ï◊ü. ◊§◊¢◊ï◊ú◊î ◊ñ◊ï ◊û◊ë◊ò◊ô◊ó◊î ◊©◊î◊†◊™◊ï◊†◊ô◊ù ◊¢◊¶◊û◊ù ◊ô◊î◊ô◊ï ◊ñ◊û◊ô◊†◊ô◊ù ◊ï◊û◊ï◊õ◊†◊ô◊ù ◊ú◊ß◊®◊ô◊ê◊î ◊ú◊§◊†◊ô ◊©◊î◊¶◊®◊õ◊ü ◊ô◊†◊°◊î ◊ú◊í◊©◊™ ◊ê◊ú◊ô◊î◊ù.</p>
</li>
<li>
<p><strong>◊¢◊ì◊õ◊ï◊ü ◊ê◊ô◊†◊ì◊ß◊° ◊î◊®◊ê◊© (<code>head</code>):</strong> ◊®◊ß ◊ú◊ê◊ó◊® ◊©◊î◊§◊®◊ô◊ò ◊î◊ï◊©◊ú◊ù ◊ï◊†◊õ◊™◊ë ◊ë◊û◊ú◊ï◊ê◊ï, ◊î◊û◊¢◊ë◊ì ◊û◊ß◊ë◊ú ◊î◊ï◊®◊ê◊î ◊ú◊¢◊ì◊õ◊ü ◊ê◊™ ◊ê◊ô◊†◊ì◊ß◊° ◊î◊®◊ê◊© (<code>head</code>), ◊û◊î ◊©◊û◊°◊û◊ü ◊©◊î◊§◊®◊ô◊ò ◊ñ◊û◊ô◊ü ◊õ◊¢◊™ ◊ú◊¶◊®◊õ◊ü.</p>
</li>
<li>
<p><strong>◊î◊™◊¢◊ï◊®◊®◊ï◊™ ◊î◊¶◊®◊õ◊ü:</strong> ◊ë◊©◊ú◊ë ◊î◊ê◊ó◊®◊ï◊ü, ◊î◊û◊¢◊ë◊ì ◊û◊¢◊ô◊® ◊ê◊™ ◊î◊¶◊®◊õ◊ü ◊ë◊ê◊û◊¶◊¢◊ï◊™ ◊ß◊®◊ô◊ê◊î ◊ú-<code>wake_up</code>, ◊ê◊ö ◊®◊ß ◊ú◊ê◊ó◊® ◊©◊ï◊ï◊ô◊ì◊ê ◊©◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊û◊¢◊ï◊ì◊õ◊ü ◊†◊õ◊™◊ë ◊ë◊û◊ú◊ï◊ê◊ï.
◊ó◊©◊ï◊ë ◊ú◊¶◊ô◊ô◊ü ◊©-<code>wake_up</code> ◊ê◊ô◊†◊î ◊û◊°◊§◊ß◊™ ◊û◊ó◊°◊ï◊ù ◊ñ◊ô◊õ◊®◊ï◊ü ◊ê◊ù ◊ê◊£ ◊™◊î◊ú◊ô◊ö ◊ê◊ô◊†◊ï ◊û◊™◊¢◊ï◊®◊® ◊ë◊§◊ï◊¢◊ú. ◊õ◊ú◊ï◊û◊®, ◊ú◊ê ◊†◊ô◊™◊ü ◊ú◊î◊°◊™◊û◊ö ◊¢◊ú◊ô◊î ◊ë◊ú◊ë◊ì ◊õ◊ì◊ô ◊ú◊î◊ë◊ò◊ô◊ó ◊°◊ì◊® ◊õ◊™◊ô◊ë◊î ◊™◊ß◊ô◊ü ◊ú◊ñ◊ô◊õ◊®◊ï◊ü.</p>
</li>
</ol>
<h4 id="◊©◊û◊ô◊®◊î-◊¢◊ú-◊ê◊ú◊û◊†◊ò-◊ê◊ó◊ì-◊®◊ô◊ß-◊ë◊û◊¢◊®◊ö">
  ◊©◊û◊ô◊®◊î ◊¢◊ú ◊ê◊ú◊û◊†◊ò ◊ê◊ó◊ì ◊®◊ô◊ß ◊ë◊û◊¢◊®◊ö
  <a class="heading-link" href="#%d7%a9%d7%9e%d7%99%d7%a8%d7%94-%d7%a2%d7%9c-%d7%90%d7%9c%d7%9e%d7%a0%d7%98-%d7%90%d7%97%d7%93-%d7%a8%d7%99%d7%a7-%d7%91%d7%9e%d7%a2%d7%a8%d7%9a">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>◊ë◊û◊¢◊®◊ö ◊©◊ú buffer ◊û◊¢◊í◊ú◊ô ◊†◊©◊û◊® ◊™◊û◊ô◊ì ◊§◊®◊ô◊ò ◊ê◊ó◊ì ◊®◊ô◊ß. ◊û◊¶◊ë ◊ñ◊î ◊û◊©◊û◊© ◊õ◊î◊í◊†◊î ◊û◊§◊†◊ô ◊î◊©◊ó◊™◊™ ◊†◊™◊ï◊†◊ô◊ù ◊ë◊û◊ß◊®◊î ◊©◊ú ◊í◊ô◊©◊î ◊û◊ß◊ë◊ô◊ú◊î ◊©◊ú ◊ô◊¶◊®◊ü ◊ï◊¶◊®◊õ◊ü.</p>
<ul>
<li>
<p><strong>◊û◊í◊ë◊ú◊™ ◊î-producer:</strong> ◊î◊ô◊¶◊®◊ü ◊ú◊ê ◊ô◊õ◊ï◊ú ◊ú◊õ◊™◊ï◊ë ◊ú-buffer ◊û◊¢◊ë◊® ◊ú◊†◊ß◊ï◊ì◊î ◊û◊°◊ï◊ô◊û◊™ ◊¢◊ì ◊©◊î◊¶◊®◊õ◊ü ◊û◊§◊†◊î ◊ê◊ú◊û◊†◊ò◊ô◊ù. ◊õ◊ì◊ô ◊ú◊í◊®◊ï◊ù ◊ú◊î◊©◊ó◊™◊™ ◊†◊™◊ï◊†◊ô◊ù, ◊î◊ô◊¶◊®◊ü ◊ô◊¶◊ò◊®◊ö ◊ú◊ô◊ô◊¶◊® ◊©◊†◊ô ◊§◊®◊ô◊ò◊ô◊ù ◊ó◊ì◊©◊ô◊ù ◊ï◊ú◊î◊í◊ô◊¢ ◊ú◊û◊ß◊ï◊ù ◊©◊ë◊ï ◊î◊¶◊®◊õ◊ü ◊¢◊ì◊ô◊ô◊ü ◊ß◊ï◊®◊ê ◊§◊®◊ô◊ò.</p>
</li>
<li>
<p><strong>◊î◊í◊†◊™ consumer:</strong> ◊î◊°◊ô◊ì◊ï◊® ◊†◊©◊û◊® ◊î◊ï◊ì◊ï◊™ ◊ú◊û◊†◊í◊†◊ï◊ü ◊î◊§◊™◊ô◊ó◊î ◊ï◊î◊†◊¢◊ô◊ú◊î ◊©◊û◊™◊®◊ó◊© ◊ë◊ô◊ü ◊î◊ß◊®◊ô◊ê◊ï◊™ ◊î◊®◊¶◊ï◊§◊ï◊™ ◊©◊ú ◊î◊¶◊®◊õ◊ü.</p>
</li>
</ul>
<h4 id="◊™◊§◊ß◊ô◊ì-◊î-lock-◊ï-unlock">
  ◊™◊§◊ß◊ô◊ì ◊î-lock ◊ï-unlock
  <a class="heading-link" href="#%d7%aa%d7%a4%d7%a7%d7%99%d7%93-%d7%94-lock-%d7%95-unlock">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>◊î◊¶◊û◊ì ◊©◊ú <code>spin_unlock()</code> ◊ï-<code>spin_lock()</code> ◊ë◊™◊î◊ú◊ô◊ö ◊î◊¶◊®◊õ◊ü ◊û◊°◊§◊ß ◊ê◊™ ◊î◊°◊ì◊® ◊î◊†◊ì◊®◊© ◊ë◊ô◊ü ◊î◊§◊¢◊ï◊ú◊ï◊™:</p>
<ol>
<li>◊ß◊®◊ô◊ê◊™ ◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊û◊°◊û◊†◊™ ◊©◊î◊¶◊®◊õ◊ü ◊§◊ô◊†◊î ◊ê◊ú◊û◊†◊ò ◊û◊°◊ï◊ô◊ù.</li>
<li>◊õ◊™◊ô◊ë◊™ ◊†◊™◊ï◊ü ◊ó◊ì◊© ◊¢◊ú ◊ô◊ì◊ô ◊î◊ô◊¶◊®◊ü ◊ë◊ê◊ï◊™◊ï ◊ê◊ú◊û◊†◊ò.</li>
</ol>
<p>◊õ◊ö ◊û◊ï◊ë◊ò◊ó ◊©◊î◊ô◊¶◊®◊ü ◊ú◊ê ◊ô◊ì◊®◊ï◊° ◊†◊™◊ï◊†◊ô◊ù ◊©◊¢◊ì◊ô◊ô◊ü ◊†◊û◊¶◊ê◊ô◊ù ◊ë◊©◊ô◊û◊ï◊© ◊î◊¶◊®◊õ◊ü, ◊ï◊©◊†◊ô◊î◊ù ◊ô◊ï◊õ◊ú◊ï ◊ú◊¢◊ë◊ï◊ì ◊ë◊û◊ß◊ë◊ô◊ú ◊™◊ï◊ö ◊©◊û◊ô◊®◊î ◊¢◊ú ◊¢◊ß◊ë◊ô◊ï◊™ ◊ñ◊ô◊õ◊®◊ï◊ü.</p>
<h3 id="◊î-consumer">
  ◊î-Consumer
  <a class="heading-link" href="#%d7%94-consumer">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊î◊¶◊®◊õ◊ü ◊ô◊ô◊®◊ê◊î ◊ë◊¢◊®◊ö ◊õ◊ö:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nf">spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">consumer_lock</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/* Read index before reading contents at that index. */</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">head</span> <span class="o">=</span> <span class="nf">smp_load_acquire</span><span class="p">(</span><span class="n">buffer</span><span class="o">-&gt;</span><span class="n">head</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">-&gt;</span><span class="n">tail</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">CIRC_CNT</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">buffer</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="cm">/* extract one item from the buffer */</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="k">struct</span> <span class="n">item</span> <span class="o">*</span><span class="n">item</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="n">tail</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="nf">consume_item</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="cm">/* Finish reading descriptor before incrementing tail. */</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="nf">smp_store_release</span><span class="p">(</span><span class="n">buffer</span><span class="o">-&gt;</span><span class="n">tail</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">                          <span class="p">(</span><span class="n">tail</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">buffer</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nf">spin_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">consumer_lock</span><span class="p">);</span>
</span></span></code></pre></div><h4 id="◊°◊ì◊®-◊í◊ô◊©◊î-◊ú-buffer">
  ◊°◊ì◊® ◊í◊ô◊©◊î ◊ú-buffer
  <a class="heading-link" href="#%d7%a1%d7%93%d7%a8-%d7%92%d7%99%d7%a9%d7%94-%d7%9c-buffer">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>◊ë◊¢◊™ ◊ß◊®◊ô◊ê◊™ ◊ê◊ï ◊õ◊™◊ô◊ë◊™ ◊†◊™◊ï◊†◊ô◊ù ◊ë-buffer, ◊î◊û◊¢◊ë◊ì ◊†◊ì◊®◊© ◊ú◊ë◊¶◊¢ ◊ê◊™ ◊î◊§◊¢◊ï◊ú◊ï◊™ ◊ë◊°◊ì◊® ◊û◊ì◊ï◊ô◊ß ◊õ◊ì◊ô ◊ú◊î◊ë◊ò◊ô◊ó ◊¢◊ß◊ë◊ô◊ï◊™ ◊†◊™◊ï◊†◊ô◊ù ◊ï◊û◊†◊ô◊¢◊™ ◊î◊©◊ó◊™◊î:</p>
<ol>
<li>
<p><strong>◊¢◊ì◊õ◊ï◊ü ◊ê◊ô◊†◊ì◊ß◊° ◊ú◊§◊†◊ô ◊ß◊®◊ô◊ê◊î:</strong> ◊¶◊®◊ô◊ö ◊ú◊ï◊ï◊ì◊ê ◊©◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊®◊ú◊ï◊ï◊†◊ò◊ô (◊ú◊ì◊ï◊í◊û◊î, ◊ê◊ô◊†◊ì◊ß◊° ◊î◊ñ◊†◊ë ◊¢◊ë◊ï◊® ◊ß◊®◊ô◊ê◊î) ◊¢◊ï◊ì◊õ◊ü ◊ë◊û◊ú◊ï◊ê◊ï ◊ú◊§◊†◊ô ◊ë◊ô◊¶◊ï◊¢ ◊ß◊®◊ô◊ê◊î ◊©◊ú ◊î◊§◊®◊ô◊ò ◊î◊ó◊ì◊©. ◊ñ◊î ◊û◊ë◊ò◊ô◊ó ◊©◊î◊¶◊®◊õ◊ü ◊ô◊ô◊í◊© ◊®◊ß ◊ú◊§◊®◊ô◊ò◊ô◊ù ◊©◊î◊ï◊õ◊†◊°◊ï ◊ú-buffer ◊ë◊û◊ú◊ï◊ê◊ù ◊¢◊ú ◊ô◊ì◊ô ◊î◊ô◊¶◊®◊ü.</p>
</li>
<li>
<p><strong>◊ß◊®◊ô◊ê◊™ ◊î◊§◊®◊ô◊ò ◊ë◊û◊ú◊ï◊ê◊ï:</strong> ◊¶◊®◊ô◊ö ◊ú◊î◊©◊ú◊ô◊ù ◊ê◊™ ◊î◊ß◊®◊ô◊ê◊î ◊©◊ú ◊î◊§◊®◊ô◊ò ◊õ◊ï◊ú◊ï ◊ú◊§◊†◊ô ◊©◊ô◊ë◊¶◊¢ ◊¢◊ì◊õ◊ï◊ü ◊©◊ú ◊ê◊ô◊†◊ì◊ß◊° ◊î◊ñ◊†◊ë. ◊¢◊ì◊õ◊ï◊ü ◊ñ◊î ◊û◊°◊û◊ü ◊©◊î◊§◊®◊ô◊ò ◊†◊ß◊®◊ê ◊ú◊ó◊ú◊ï◊ò◊ô◊ü ◊ï◊†◊ô◊™◊ü ◊ú◊û◊ó◊ï◊ß ◊ê◊ï◊™◊ï ◊û◊î-buffer ◊ê◊ï ◊ú◊î◊ó◊ú◊ô◊§◊ï ◊ë◊§◊®◊ô◊ò ◊ó◊ì◊©.</p>
</li>
</ol>
<h4 id="◊©◊ô◊û◊ï◊©-◊ë-read_once-◊ï◊ë-smp_load_acquire">
  ◊©◊ô◊û◊ï◊© ◊ë-<code>READ_ONCE</code> ◊ï◊ë-<code>smp_load_acquire</code>
  <a class="heading-link" href="#%d7%a9%d7%99%d7%9e%d7%95%d7%a9-%d7%91-read_once-%d7%95%d7%91-smp_load_acquire">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ol>
<li>
<p>◊î-<strong><code>READ_ONCE</code>:</strong></p>
<ul>
<li>◊ß◊®◊ô◊ê◊î ◊¢◊ù <code>READ_ONCE</code> ◊û◊ë◊ò◊ô◊ó◊î ◊©◊î◊¢◊®◊ö ◊©◊ú ◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊†◊í◊ì◊ô (opposition), ◊ú◊ì◊ï◊í◊û◊î, ◊ê◊ô◊†◊ì◊ß◊° ◊î◊®◊ê◊© ◊ê◊ï ◊î◊ñ◊†◊ë ◊©◊ú ◊î◊¶◊ì ◊î◊©◊†◊ô, ◊ô◊ô◊ß◊®◊ê ◊ë◊ì◊ô◊ï◊ß ◊§◊¢◊ù ◊ê◊ó◊™.</li>
<li>◊î-<code>READ_ONCE</code> ◊û◊ï◊†◊¢ ◊û◊î◊ß◊ï◊û◊§◊ô◊ô◊ú◊® ◊ú◊ë◊¶◊¢ ◊ê◊ï◊§◊ò◊ô◊û◊ô◊ñ◊¶◊ô◊ï◊™ ◊õ◊û◊ï ◊î◊©◊û◊ò◊™ ◊ß◊®◊ô◊ê◊î ◊ê◊ï ◊ò◊¢◊ô◊†◊î ◊û◊ó◊ì◊© ◊©◊ú ◊î◊¢◊®◊ö ◊û◊ñ◊ô◊õ◊®◊ï◊ü, ◊û◊î ◊©◊¢◊ú◊ï◊ú ◊ú◊í◊®◊ï◊ù ◊ú◊î◊™◊†◊î◊í◊ï◊™ ◊ú◊ê ◊¢◊ß◊ë◊ô◊™ ◊ë◊í◊ô◊©◊î ◊ú-buffer.</li>
</ul>
<p>◊ê◊ù ◊ê◊™◊î ◊ë◊ò◊ï◊ó ◊©◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊†◊í◊ì◊ô ◊†◊ß◊®◊ê ◊®◊ß ◊§◊¢◊ù ◊ê◊ó◊™ ◊ë◊î◊ß◊©◊® ◊î◊†◊ï◊õ◊ó◊ô, ◊ô◊ô◊™◊õ◊ü ◊©◊ú◊ê ◊ô◊î◊ô◊î ◊¶◊ï◊®◊ö ◊ú◊î◊©◊™◊û◊© ◊ë-<code>READ_ONCE</code>.</p>
</li>
<li>
<p>◊î-<strong><code>smp_load_acquire</code>:</strong></p>
<ul>
<li>◊ß◊®◊ô◊ê◊î ◊ñ◊ï ◊û◊°◊§◊ß◊™ ◊©◊õ◊ë◊™ ◊î◊í◊†◊î ◊†◊ï◊°◊§◊™ ◊ë◊õ◊ö ◊©◊î◊ô◊ê ◊û◊ê◊ú◊¶◊™ ◊ê◊™ ◊î◊û◊¢◊ë◊ì ◊ú◊©◊û◊ï◊® ◊¢◊ú ◊°◊ì◊® ◊í◊ô◊©◊î ◊ú◊ñ◊ô◊õ◊®◊ï◊ü.</li>
<li>◊ë◊û◊ß◊®◊î ◊ñ◊î, ◊î◊ô◊ê ◊û◊ë◊ò◊ô◊ó◊î ◊©◊õ◊ú ◊§◊¢◊ï◊ú◊ï◊™ ◊î◊ß◊®◊ô◊ê◊î ◊©◊ë◊ï◊¶◊¢◊ï ◊ú◊§◊†◊ô ◊î◊ß◊®◊ô◊ê◊î ◊ú-<code>smp_load_acquire</code> ◊î◊ï◊©◊ú◊û◊ï ◊ú◊§◊†◊ô ◊í◊ô◊©◊î ◊ú◊¢◊®◊õ◊ô◊ù ◊ó◊ì◊©◊ô◊ù, ◊õ◊ï◊ú◊ú ◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊†◊í◊ì◊ô. ◊î◊ì◊ë◊® ◊ó◊ô◊ï◊†◊ô ◊ú◊©◊û◊ô◊®◊î ◊¢◊ú ◊¢◊ß◊ë◊ô◊ï◊™ ◊ë◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊°◊ë◊ô◊ë◊ï◊™ ◊®◊ô◊ë◊ï◊ô-◊û◊¢◊ë◊ì◊ô◊ù (SMP).</li>
</ul>
</li>
</ol>
<h4 id="◊©◊ô◊û◊ï◊©-◊ë-smp_store_release">
  ◊©◊ô◊û◊ï◊© ◊ë-<code>smp_store_release</code>
  <a class="heading-link" href="#%d7%a9%d7%99%d7%9e%d7%95%d7%a9-%d7%91-smp_store_release">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>◊ë◊ì◊ï◊û◊î ◊ú-<code>smp_load_acquire</code>, ◊î◊©◊ô◊û◊ï◊© ◊ë-<code>smp_store_release</code> ◊û◊°◊§◊ß ◊©◊õ◊ë◊™ ◊î◊í◊†◊î ◊ë◊õ◊™◊ô◊ë◊™ ◊¢◊®◊õ◊ô◊ù ◊ú-buffer:</p>
<ol>
<li>
<p><strong>◊¢◊ì◊õ◊ï◊ü ◊î◊ê◊ô◊†◊ì◊ß◊°:</strong></p>
<ul>
<li>◊§◊¢◊ï◊ú◊î ◊ñ◊ï ◊û◊™◊¢◊ì◊™ ◊ê◊™ ◊î◊¢◊ï◊ë◊ì◊î ◊©◊î◊ê◊ô◊†◊ì◊ß◊° ◊î◊†◊ï◊õ◊ó◊ô ◊†◊õ◊™◊ë, ◊õ◊ö ◊©◊¶◊ì ◊ê◊ó◊® ◊ë◊û◊¢◊®◊õ◊™ (◊ú◊û◊©◊ú, ◊î◊¶◊®◊õ◊ü ◊ë◊û◊ß◊®◊î ◊©◊ú ◊ô◊¶◊®◊ü) ◊ô◊ï◊õ◊ú ◊ú◊ß◊®◊ï◊ê ◊ê◊ï◊™◊ï ◊ë◊¶◊ï◊®◊î ◊ë◊ò◊ï◊ó◊î.</li>
</ul>
</li>
<li>
<p><strong>◊û◊†◊ô◊¢◊™ tearing:</strong></p>
<ul>
<li>◊î-<code>smp_store_release</code> ◊û◊ï◊†◊¢ ◊û◊î◊ß◊ï◊û◊§◊ô◊ô◊ú◊® ◊ú◊ë◊¶◊¢ ◊ê◊ï◊§◊ò◊ô◊û◊ô◊ñ◊¶◊ô◊ï◊™ ◊©◊û◊§◊¶◊ú◊ï◊™ ◊ê◊™ ◊î◊õ◊™◊ô◊ë◊î (tearing) ◊ê◊ï ◊ì◊ï◊ó◊ï◊™ ◊ê◊ï◊™◊î, ◊ì◊ë◊® ◊©◊¢◊ú◊ï◊ú ◊ú◊î◊ï◊ë◊ô◊ú ◊ú◊û◊¶◊ë ◊©◊ë◊ï ◊ê◊ô◊†◊ì◊ß◊° ◊ó◊ú◊ß◊ô ◊†◊ó◊©◊£ ◊ú◊¶◊ì ◊î◊©◊†◊ô ◊ú◊§◊†◊ô ◊©◊î◊©◊ô◊†◊ï◊ô◊ô◊ù ◊î◊°◊™◊ô◊ô◊û◊ï.</li>
</ul>
</li>
<li>
<p><strong>◊°◊ì◊® ◊ë◊ñ◊ô◊õ◊®◊ï◊ü:</strong></p>
<ul>
<li>◊§◊¢◊ï◊ú◊™ ◊î-release ◊û◊ë◊ò◊ô◊ó◊î ◊©◊õ◊ú ◊î◊í◊ô◊©◊ï◊™ ◊ú◊ñ◊ô◊õ◊®◊ï◊ü ◊©◊ë◊ï◊¶◊¢◊ï ◊ú◊§◊†◊ô ◊î◊õ◊™◊ô◊ë◊î ◊ú◊ê◊ô◊†◊ì◊ß◊° ◊™◊ï◊©◊ú◊ù ◊ú◊§◊†◊ô ◊©◊î◊ê◊ô◊†◊ì◊ß◊° ◊¢◊¶◊û◊ï ◊ô◊ô◊õ◊™◊ë. ◊õ◊ö ◊û◊ï◊ë◊ò◊ó◊™ ◊¢◊ß◊ë◊ô◊ï◊™ ◊ë◊ô◊ü ◊õ◊™◊ô◊ë◊™ ◊î◊§◊®◊ô◊ò ◊ï◊¢◊ì◊õ◊ï◊ü ◊î◊ê◊ô◊†◊ì◊ß◊°.</li>
</ul>
</li>
</ol>
<h4 id="◊û◊ë◊ó◊ü-◊ú◊ß◊û◊ï◊°">
  ◊û◊ë◊ó◊ü ◊ú◊ß◊û◊ï◊°
  <a class="heading-link" href="#%d7%9e%d7%91%d7%97%d7%9f-%d7%9c%d7%a7%d7%9e%d7%95%d7%a1">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>◊î◊û◊ë◊ó◊ü ◊î◊ï◊ê ◊°◊ï◊í ◊©◊ú ◊©◊ô◊ú◊ï◊ë ◊©◊ú ◊î◊™◊ë◊†◊ô◊ï◊™ LB ◊ï-MP ◊ë◊î◊™◊ê◊û◊î ◊ë-2 ◊î◊¶◊ì◊ì◊ô◊ù (◊í◊ù ◊ë◊ô◊¶◊®◊ü ◊ï◊í◊ù ◊ë◊¶◊®◊õ◊ü).</p>
<p>◊î◊®◊¢◊ô◊ï◊ü ◊õ◊ê◊ü ◊î◊ï◊ê ◊ë◊¢◊¶◊ù ◊©◊†◊ô thread-◊ô◊ù ◊ï◊©◊†◊ô ◊ì◊í◊ú◊ô◊ù ◊ë◊î◊™◊ê◊û◊î (◊ì◊í◊ú ◊ú◊õ◊ú thread) ◊ï◊ô◊© ◊ë◊†◊ï◊°◊£ ◊û◊©◊™◊†◊î buff ◊©◊û◊ô◊ô◊¶◊í ◊ê◊™ ◊î-buffer ◊©◊î◊ï◊ê ◊†◊õ◊™◊ë ◊¢◊ú ◊ô◊ì◊ô thread ◊î◊ô◊¶◊®◊ü ◊ï◊†◊ß◊®◊ê ◊¢◊ú ◊ô◊ì◊ô thread ◊î◊¶◊®◊õ◊ü.
◊©◊†◊ô ◊î◊¶◊ì◊ì◊ô◊ù ◊ì◊ï◊û◊ô◊ù ◊ë-2 ◊†◊ß◊ï◊ì◊ï◊™:</p>
<ul>
<li>◊õ◊ú ◊¶◊ì ◊õ◊ï◊™◊ë ◊ì◊í◊ú ◊ï◊ß◊ï◊®◊ê ◊ì◊í◊ú ◊ë◊î◊™◊ê◊û◊î</li>
<li>◊õ◊ú ◊¶◊ì ◊¶◊®◊ô◊ö ◊ú◊î◊ô◊ï◊™ ◊™◊ú◊ï◊ô ◊ë◊¢◊®◊ö ◊©◊ú 2 ◊î◊ì◊í◊ú◊ô◊ù</li>
</ul>
<p>◊î◊ô◊¶◊®◊ü ◊ï◊î◊¶◊®◊õ◊ü ◊õ◊û◊¢◊ò ◊°◊û◊ò◊®◊ô◊ù ◊ó◊ï◊• ◊û◊©◊î◊ô◊¶◊®◊ü ◊õ◊ï◊™◊ë ◊ú-buff ◊ï◊î◊¶◊®◊õ◊ü ◊ß◊ï◊®◊ê ◊û-buff, ◊ê◊ë◊ú ◊ë◊í◊ú◊ú ◊î◊î◊ë◊ì◊ú ◊î◊ñ◊î ◊ê◊ñ ◊î◊¶◊®◊õ◊ü ◊¶◊®◊ô◊ö ◊¢◊ï◊ì ◊û◊ó◊°◊ï◊ù ◊õ◊ì◊ô ◊ú◊î◊™◊í◊ë◊® ◊¢◊ú ◊ó◊ï◊°◊® ◊°◊ì◊® ◊ë◊í◊ú◊ú ◊©◊ê◊ô◊ü ◊™◊ú◊ï◊™ ◊ë◊ô◊ü load-◊ô◊ù ◊ë-if ◊ë◊¶◊®◊õ◊ü ◊ê◊ë◊ú ◊ú◊¢◊ï◊û◊™ ◊ñ◊ê◊™ ◊ë◊ô◊¶◊®◊ü ◊ô◊© ◊™◊ú◊ï◊™ ◊©◊í◊ï◊®◊û◊™ ◊ú◊°◊ì◊® ◊ë◊í◊ú◊ú ◊©◊ô◊© load ◊ï◊ú◊ê◊ó◊® ◊û◊õ◊ü store.</p>
<p>◊î◊¢◊®◊î:
◊ô◊© ◊ë◊¢◊ô◊î ◊ë◊ñ◊û◊ü ◊î◊®◊¶◊î ◊ë◊ú◊î◊¶◊ô◊í ◊ê◊™ ◊î◊¶◊ï◊®◊ö ◊õ◊ê◊ü ◊ë-<code>smp_store_release</code> ◊ë◊¶◊®◊õ◊ü ◊ë◊í◊ú◊ú ◊©◊ê◊ô◊ü ◊ë◊û◊ë◊ó◊ü ◊¢◊¶◊û◊ï (◊ë◊ß◊ï◊ì ◊î◊ê◊û◊ô◊™◊ô ◊ô◊©) ◊ë◊ê◊û◊™ ◊™◊ú◊ï◊™ ◊ê◊û◊ô◊™◊ô◊™ ◊ë◊°◊ì◊® ◊©◊î-<code>smp_store_release</code> ◊ô◊ï◊¶◊® ◊ï◊ú◊õ◊ü ◊í◊ù ◊ê◊ù ◊õ◊ê◊ü ◊†◊ó◊ú◊ô◊£ ◊ê◊ï◊™◊ï ◊ë-<code>WRITE_ONCE</code> ◊ê◊ñ ◊î◊û◊ë◊ó◊ü ◊ô◊®◊ê◊î ◊©◊ê◊ô◊ü ◊ë◊¢◊ô◊ï◊™ ◊ú◊û◊®◊ï◊™ ◊©◊õ◊ü ◊ô◊© ◊¶◊ï◊®◊ö ◊ë◊ï.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">C</span> <span class="n">circular</span><span class="o">-</span><span class="n">buffer</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">	<span class="kt">int</span> <span class="o">*</span><span class="n">head</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">	<span class="kt">int</span> <span class="o">*</span><span class="n">tail</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">	<span class="kt">int</span> <span class="o">*</span><span class="n">buff</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nf">P0</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">head</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">tail</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">buff</span><span class="p">)</span> <span class="c1">// producer
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">	<span class="kt">int</span> <span class="n">r0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">	<span class="kt">int</span> <span class="n">r1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">	
</span></span><span class="line"><span class="ln">15</span><span class="cl">	<span class="n">r0</span> <span class="o">=</span> <span class="nf">READ_ONCE</span><span class="p">(</span><span class="o">*</span><span class="n">tail</span><span class="p">);</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"></span>	<span class="n">r1</span> <span class="o">=</span> <span class="o">*</span><span class="n">head</span><span class="p">;</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"></span>	<span class="k">if</span><span class="p">(</span><span class="n">r0</span> <span class="o">+</span> <span class="n">r1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">		<span class="o">*</span><span class="n">buff</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">		<span class="nf">smp_store_release</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">r1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nf">P1</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">head</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">tail</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">buff</span><span class="p">)</span> <span class="c1">// consumer
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">	<span class="kt">int</span> <span class="n">r2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">	<span class="kt">int</span> <span class="n">r3</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">	<span class="kt">int</span> <span class="n">r4</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">	
</span></span><span class="line"><span class="ln">29</span><span class="cl">	<span class="n">r2</span> <span class="o">=</span> <span class="nf">smp_load_acquire</span><span class="p">(</span><span class="n">head</span><span class="p">);</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="c1"></span>	<span class="n">r3</span> <span class="o">=</span> <span class="o">*</span><span class="n">tail</span><span class="p">;</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="c1"></span>	<span class="k">if</span><span class="p">(</span><span class="n">r2</span> <span class="o">+</span> <span class="n">r3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">		<span class="n">r4</span> <span class="o">=</span> <span class="o">*</span><span class="n">buff</span><span class="p">;</span> <span class="c1">// 1 (Shouldn&#39;t happen)
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="c1"></span>		<span class="nf">smp_store_release</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">r3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="c1">// (* exists (0:r0=1 /\ 0:r1=1 /\ 1:r2=2 /\ 1:r3=1 /\ 1:r4=1) *)
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="c1"></span><span class="nf">exists</span> <span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="n">r2</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span><span class="err">\</span> <span class="mi">1</span><span class="o">:</span><span class="n">r4</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h2 id="◊ì◊ï◊í◊û◊ê◊ï◊™-◊ë◊ß◊®◊†◊ú">
  ◊ì◊ï◊í◊û◊ê◊ï◊™ ◊ë◊ß◊®◊†◊ú
  <a class="heading-link" href="#%d7%93%d7%95%d7%92%d7%9e%d7%90%d7%95%d7%aa-%d7%91%d7%a7%d7%a8%d7%a0%d7%9c">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="◊ì◊ï◊í◊û◊î-◊ú◊™◊ë◊†◊ô◊™-mp-◊ë◊ß◊®◊†◊ú">
  ◊ì◊ï◊í◊û◊î ◊ú◊™◊ë◊†◊ô◊™ MP ◊ë◊ß◊®◊†◊ú
  <a class="heading-link" href="#%d7%93%d7%95%d7%92%d7%9e%d7%94-%d7%9c%d7%aa%d7%91%d7%a0%d7%99%d7%aa-mp-%d7%91%d7%a7%d7%a8%d7%a0%d7%9c">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊ì◊ï◊í◊û◊î ◊ì◊ô ◊§◊©◊ï◊ò◊î ◊ë◊ß◊®◊†◊ú ◊ú◊™◊ë◊†◊ô◊™ MP  ◊ê◊§◊©◊® ◊ú◊û◊¶◊ï◊ê ◊ë◊î◊®◊ë◊î ◊û◊ß◊ï◊û◊ï◊™.</p>
<p>◊ë◊§◊ï◊†◊ß◊¶◊ô◊î <code>fsnotify_add_mark_list</code> ◊ë◊ß◊ï◊ë◊• <code>fs/notify/mark.c</code> ◊ê◊§◊©◊® ◊ú◊®◊ê◊ï◊™ (◊í◊ù ◊û◊í◊ô◊¢ ◊¢◊ù ◊î◊°◊ë◊® ◊ë◊î◊¢◊®◊ï◊™) ◊©◊î◊§◊ï◊†◊ß◊¶◊ô◊î ◊î◊ô◊ê ◊¶◊ì ◊î-producer ◊ï◊ô◊© ◊õ◊™◊ô◊ë◊î ◊©◊ú ◊¢◊®◊ö ◊ó◊ì◊© ◊ï◊ú◊ê◊ó◊® ◊û◊õ◊ü ◊û◊ì◊ú◊ô◊ß◊ô◊ù ◊ì◊í◊ú ◊©◊û◊°◊û◊ü ◊ú-consumer ◊©◊î◊†◊™◊ï◊†◊ô◊ù ◊†◊õ◊™◊ë◊ï.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">conn</span><span class="o">-&gt;</span><span class="n">fsid</span> <span class="o">=</span> <span class="o">*</span><span class="n">fsid</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="cm">/* Pairs with smp_rmb() in fanotify_get_fsid() */</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nf">smp_wmb</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="n">conn</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">FSNOTIFY_CONN_FLAG_HAS_FSID</span><span class="p">;</span>
</span></span></code></pre></div><p>◊ñ◊î ◊†◊¢◊©◊î ◊¢◊ú ◊ô◊ì◊ô:</p>
<ol>
<li>◊î◊õ◊™◊ô◊ë◊î ◊©◊ú ◊î◊û◊ô◊ì◊¢ ◊¢◊¶◊û◊ï ◊ú-<code>conn-&gt;fsid</code></li>
<li>◊ú◊ê◊ó◊® ◊û◊õ◊ü ◊û◊ï◊°◊ô◊§◊ô◊ù ◊û◊ó◊°◊ï◊ù ◊õ◊™◊ô◊ë◊î <code>wmb</code></li>
<li>◊ï◊ú◊ë◊°◊ï◊£ ◊õ◊ï◊™◊ë◊ô◊ù ◊ú-<code>conn-&gt;flags</code>.</li>
</ol>
<p>◊ë◊¶◊ì ◊î-consumer ◊©◊†◊û◊¶◊ê ◊ë◊§◊ï◊†◊ß◊¶◊ô◊î <code>fanotify_get_fsid</code> ◊ë◊ß◊ï◊ë◊• <code>fs/notify/fanotify/fanotify.c</code> ◊í◊ù ◊§◊©◊ï◊ò:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">conn</span> <span class="o">=</span> <span class="nf">READ_ONCE</span><span class="p">(</span><span class="n">mark</span><span class="o">-&gt;</span><span class="n">connector</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="cm">/* Mark is just getting destroyed or created? */</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">conn</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">	<span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">conn</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">FSNOTIFY_CONN_FLAG_HAS_FSID</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">	<span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="cm">/* Pairs with smp_wmb() in fsnotify_add_mark_list() */</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="nf">smp_rmb</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="n">fsid</span> <span class="o">=</span> <span class="n">conn</span><span class="o">-&gt;</span><span class="n">fsid</span><span class="p">;</span>
</span></span></code></pre></div><p>◊õ◊ê◊ü ◊ì◊ë◊® ◊®◊ê◊©◊ï◊ü ◊û◊ë◊¶◊¢◊ô◊ù ◊ß◊®◊ô◊ê◊î ◊©◊ú <code>mark-&gt;connector</code> ◊ï◊ë◊ï◊ì◊ß◊ô◊ù ◊ê◊ù ◊î◊ï◊ê ◊ß◊ô◊ô◊ù ◊ï◊ê◊ù ◊î◊ì◊í◊ú <code>FSNOTIFY_CONN_FLAG_HAS_FSID</code> ◊ì◊ú◊ï◊ß (◊©◊ê◊™ ◊î◊ì◊í◊ú ◊î◊ñ◊î ◊û◊ì◊ú◊ô◊ß◊ô◊ù ◊ë-producer) ◊ï◊ê◊ù ◊õ◊ü ◊ê◊ñ ◊û◊ë◊¶◊¢◊ô◊ù ◊ß◊®◊ô◊ê◊î ◊©◊ú <code>conn-&gt;fsid</code>.</p>
<p>◊ë◊û◊ß◊®◊î ◊î◊ñ◊î ◊ï◊ë◊õ◊ú◊ú◊ô ◊ë-MP ◊ô◊© ◊¶◊ï◊®◊ö ◊ë◊û◊ó◊°◊ï◊û◊ô◊ù ◊õ◊ì◊ô ◊©◊ú◊ê ◊ô◊ß◊®◊î ◊û◊¶◊ë ◊©◊î-consumer ◊ô◊†◊°◊î ◊ú◊ß◊®◊ï◊ê ◊û◊ô◊ì◊¢ ◊ú◊§◊†◊ô ◊©◊î◊ï◊ê ◊†◊õ◊™◊ë ◊¢◊ú ◊ô◊ì◊ô ◊î-producer ◊ï◊ñ◊î ◊û◊¶◊®◊ô◊ö ◊û◊ó◊°◊ï◊û◊ô◊ù ◊ë-consumer ◊ï◊í◊ù ◊ë-producer ◊õ◊ô ◊õ◊ú ◊ê◊ó◊ì ◊û◊î◊ù ◊ô◊õ◊ï◊ú ◊ú◊ë◊¶◊¢ ◊ê◊™ ◊î◊î◊ï◊®◊ê◊ï◊™ ◊©◊ú◊ï ◊ë◊¶◊ï◊®◊î out-of-order.</p>
<h3 id="◊ì◊ï◊í◊û◊î-◊ú◊™◊ë◊†◊ô◊™-sb-◊ë◊ß◊®◊†◊ú">
  ◊ì◊ï◊í◊û◊î ◊ú◊™◊ë◊†◊ô◊™ SB ◊ë◊ß◊®◊†◊ú
  <a class="heading-link" href="#%d7%93%d7%95%d7%92%d7%9e%d7%94-%d7%9c%d7%aa%d7%91%d7%a0%d7%99%d7%aa-sb-%d7%91%d7%a7%d7%a8%d7%a0%d7%9c">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>◊ë◊™◊ë◊†◊ô◊™ SB ◊õ◊ú ◊¶◊ì ◊î◊ï◊ê ◊í◊ù ◊õ◊ï◊™◊ë ◊ï◊í◊ù ◊ß◊ï◊®◊ê, ◊ï◊õ◊ú ◊¶◊ì ◊ß◊ï◊®◊ê ◊ê◊™ ◊î◊û◊ô◊ì◊¢ ◊©◊î◊¶◊ì ◊î◊©◊†◊ô ◊õ◊™◊ë.
◊ì◊ï◊í◊û◊î ◊ú◊™◊ë◊†◊ô◊™ ◊î◊ô◊ê ◊ë◊ß◊ï◊ë◊• <code>fs/fuse/dev.c</code> ◊ë◊§◊ï◊†◊ß◊¶◊ô◊ï◊™ <code>request_wait_answer</code> ◊ï-<code>fuse_dev_do_read</code>.</p>
<p>◊ë◊§◊ï◊†◊ß◊¶◊ô◊ï◊™ ◊î◊ê◊ú◊î ◊õ◊ú ◊¶◊ì ◊û◊ì◊ú◊ô◊ß ◊ë◊ô◊ò ◊ë◊©◊ì◊î ◊ë◊ì◊í◊ú ◊ï◊ú◊ê◊ó◊® ◊û◊õ◊ü ◊ë◊ï◊ì◊ß ◊ê◊ù ◊ë◊ô◊ò ◊ê◊ó◊® ◊ì◊ú◊ï◊ß ◊ë◊ì◊í◊ú ◊ï◊î◊ë◊ô◊ò ◊î◊ñ◊î ◊†◊ì◊ú◊ß ◊¢◊ú ◊ô◊ì◊ô ◊î◊¶◊ì ◊î◊©◊†◊ô.</p>
<p>◊î◊§◊ï◊†◊ß◊¶◊ô◊î <code>request_wait_answer</code>:
<a href="https://elixir.bootlin.com/linux/v6.4.11/source/fs/fuse/dev.c#L364"  class="external-link" target="_blank" rel="noopener">◊ß◊ô◊©◊ï◊®</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln">1</span><span class="cl"><span class="nf">set_bit</span><span class="p">(</span><span class="n">FR_INTERRUPTED</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="cm">/* matches barrier in fuse_dev_do_read() */</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nf">smp_mb__after_atomic</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">test_bit</span><span class="p">(</span><span class="n">FR_SENT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">	<span class="p">...</span>
</span></span></code></pre></div><p>◊ë◊î◊™◊ó◊ú◊î ◊†◊¢◊©◊ô◊™ ◊õ◊™◊ô◊ë◊î ◊ú-<code>req-&gt;flags</code> ◊ë◊ë◊ô◊ò ◊ë◊û◊ô◊ß◊ï◊ù <code>FR_INTERRUPTED</code> ◊¢◊ú ◊ô◊ì◊ô ◊î◊§◊¢◊ï◊ú◊î ◊î◊ê◊ò◊ï◊û◊ô◊™ <code>set_bit</code> ◊ï◊ú◊û◊®◊ï◊™ ◊©◊î◊ô◊ê ◊ê◊ò◊ï◊û◊ô◊™ ◊î◊ô◊ê ◊ú◊ê ◊û◊®◊û◊ñ◊™ ◊¢◊ú ◊û◊ó◊°◊ï◊ù ◊ï◊ú◊õ◊ü ◊¶◊®◊ô◊ö ◊ú◊î◊ï◊°◊ô◊£ ◊ú◊î ◊û◊ó◊°◊ï◊ù, ◊ë◊í◊ú◊ú ◊©◊ê◊†◊ó◊†◊ï ◊®◊ï◊¶◊ô◊ù ◊°◊ì◊® ◊ë◊ô◊ü ◊õ◊™◊ô◊ë◊î ◊ú◊ß◊®◊ô◊ê◊î ◊ê◊†◊ó◊†◊ï ◊¶◊®◊ô◊õ◊ô◊ù ◊û◊ó◊°◊ï◊ù ◊ó◊ñ◊ß ◊ê◊ó◊®◊ô ◊î◊§◊¢◊ï◊ú◊î ◊î◊ê◊ò◊ï◊û◊ô◊™ ◊ï◊î◊û◊ó◊°◊ï◊ù ◊î◊û◊™◊ê◊ô◊ù ◊ú◊ñ◊î ◊î◊ï◊ê <code>smp_mb__after_atomic</code>.
◊ú◊ê◊ó◊® ◊î◊û◊ó◊°◊ï◊ù ◊ô◊© ◊ß◊®◊ô◊ê◊î ◊¢◊ú ◊î◊ì◊í◊ú <code>req-&gt;flags</code>  ◊ë◊ë◊ô◊ò ◊ë◊û◊ô◊ß◊ï◊ù <code>FR_SENT</code>.</p>
<p>◊õ◊ê◊ü ◊ô◊© ◊û◊©◊î◊ï ◊©◊†◊®◊ê◊î ◊ß◊¶◊™ ◊û◊ï◊ñ◊®, ◊ú◊û◊î ◊¶◊®◊ô◊ö ◊ú◊î◊ï◊°◊ô◊£ ◊û◊ó◊°◊ï◊ù ◊ê◊ù ◊í◊ù ◊î◊õ◊™◊ô◊ë◊î ◊ï◊í◊ù ◊î◊ß◊®◊ô◊ê◊î ◊†◊¢◊©◊ô◊ù ◊¢◊ú ◊ê◊ï◊™◊ï ◊û◊©◊™◊†◊î (<code>req-&gt;flags</code>), ◊ú◊®◊ï◊ë ◊ê◊†◊ó◊†◊ï ◊û◊¶◊§◊ô◊ù ◊©◊û◊ì◊ï◊ë◊® ◊¢◊ú ◊ê◊ï◊™◊ï ◊û◊©◊™◊†◊î ◊ê◊ñ ◊í◊ù ◊ê◊ù ◊ô◊© ◊õ◊™◊ô◊ë◊î ◊ï◊ê◊ó◊®◊ô◊î ◊ß◊®◊ô◊ê◊î ◊ë◊ê◊ï◊™◊ï thread ◊î◊ß◊®◊ô◊ê◊î ◊™◊°◊ï◊§◊ß ◊û◊¢◊®◊ö ◊ó◊ì◊© ◊ú◊§◊ó◊ï◊™ ◊õ◊û◊ï ◊î◊õ◊™◊ô◊ë◊î, ◊ñ◊î ◊ô◊õ◊ï◊ú ◊ú◊ß◊®◊ï◊™ ◊ë◊í◊ú◊ú ◊©◊ñ◊î ◊ê◊ï◊™◊ï ◊û◊©◊™◊†◊î ◊ê◊ë◊ú ◊ú◊ê ◊ë◊ì◊ô◊ï◊ß ◊ê◊ï◊™◊î ◊õ◊™◊ï◊ë◊™ (◊î-offset ◊©◊ú ◊î◊ë◊ô◊ò◊ô◊ù ◊©◊ï◊†◊î ◊ë◊™◊ï◊ö ◊î◊ì◊í◊ú) ◊ê◊ñ ◊ô◊õ◊ï◊ú ◊ú◊î◊ô◊ï◊™ ◊õ◊ê◊ü ◊°◊ô◊ì◊ï◊® ◊û◊ó◊ì◊©.</p>
<p>◊î◊§◊ï◊†◊ß◊¶◊ô◊î <code>fuse_dev_do_read</code>:
<a href="https://elixir.bootlin.com/linux/v6.4.11/source/fs/fuse/dev.c#L1204"  class="external-link" target="_blank" rel="noopener">◊ß◊ô◊©◊ï◊®</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="ln">1</span><span class="cl"><span class="nf">set_bit</span><span class="p">(</span><span class="n">FR_SENT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nf">spin_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fpq</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="cm">/* matches barrier in request_wait_answer() */</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nf">smp_mb__after_atomic</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">test_bit</span><span class="p">(</span><span class="n">FR_INTERRUPTED</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">	<span class="p">...</span>
</span></span></code></pre></div><p>◊í◊ù ◊õ◊ê◊ü ◊ê◊†◊ó◊†◊ï ◊®◊ï◊ê◊ô◊ù ◊ê◊™ ◊ê◊ï◊™◊ù ◊î◊ì◊ë◊®◊ô◊ù ◊©◊î◊ô◊ï ◊ë-<code>request_wait_answer</code> ◊®◊ß ◊©◊î◊û◊©◊™◊†◊ô◊ù ◊î◊§◊ï◊õ◊ô◊ù, ◊õ◊ú◊ï◊û◊® ◊ô◊© ◊õ◊™◊ô◊ë◊î ◊ú◊ì◊í◊ú ◊ë◊ë◊ô◊ò ◊ë◊û◊ô◊ß◊ï◊ù <code>FR_SENT</code> ◊ï◊ú◊ê◊ó◊® ◊û◊õ◊ü ◊û◊ó◊°◊ï◊ù ◊ï◊ê◊ó◊®◊ô◊ï ◊ß◊®◊ô◊ê◊î ◊û◊î◊ì◊í◊ú ◊ë◊ë◊ô◊ò ◊ë◊û◊ô◊ß◊ï◊ù <code>FR_INTERRUPTED</code>.</p>

      </div>


      <footer>
        
  <h3 dir="rtl">
    ◊û◊ß◊ï◊®◊ï◊™
  </h3>
  <ul dir="ltr">
  
    <li>
      <a href="https://docs.kernel.org/core-api/circular-buffers.html">https://docs.kernel.org/core-api/circular-buffers.html</a>
    </li>
  
    <li>
      <a href="https://www.kernel.org/doc/html/v5.1/core-api/atomic_ops.html#atomic-bitmask">https://www.kernel.org/doc/html/v5.1/core-api/atomic_ops.html#atomic-bitmask</a>
    </li>
  
    <li>
      <a href="https://www.kernel.org/doc/Documentation/memory-barriers.txt">https://www.kernel.org/doc/Documentation/memory-barriers.txt</a>
    </li>
  

        

<section class="see-also">
  
    
    
    
      <h3 id="◊®◊ï◊ê◊î-◊¢◊ï◊ì-◊ë-memory-models" dir="rtl">        ◊®◊ï◊ê◊î ◊¢◊ï◊ì ◊ë memory-models
        <a class="heading-link" href="#%d7%a8%d7%95%d7%90%d7%94-%d7%a2%d7%95%d7%93-%d7%91-memory-models">
          <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
          <span class="sr-only">Link to heading</span>
        </a>
      </h3>
      <nav>
        <ul>
        
        
          
        
          
            <li>
              <a href="/he/posts/models/lkmm/">LKMM</a>
            </li>
          
        
          
            <li>
              <a href="/he/posts/models/dependency/">Dependency</a>
            </li>
          
        
          
            <li>
              <a href="/he/posts/models/herd7/">Herd7</a>
            </li>
          
        
          
            <li>
              <a href="/he/posts/models/models/">Models</a>
            </li>
          
        
          
            <li>
              <a href="/he/posts/models/base-formal/">Base Formal</a>
            </li>
          
        
        </ul>
      </nav>
    
  
</section>


        
        
        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script><style>
  .katex {
    direction: ltr;
    display: inline-flex;
    flex-direction: row-reverse;
    unicode-bidi: embed;
  }
</style>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ¬©
    
    2025
     Michael Shalitin 
    ¬∑
    
    ◊û◊ï◊§◊¢◊ú ◊¢◊ú ◊ô◊ì◊ô <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  
<script defer src='https://static.cloudflareinsights.com/beacon.min.js'
        data-cf-beacon='{"token": "316bf5f2576c4cb68b54c0b2a91cb739"}'></script>



  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
